---
layout: default
---

<head>
<meta http-equiv=Content-Type content="text/html; charset=utf-8">
<meta name=Generator content="Microsoft Word 12 (filtered)">
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Helvetica;
	panose-1:2 11 6 4 2 2 2 2 2 4;}
@font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:宋体;
	panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
	{font-family:黑体;
	panose-1:2 1 6 9 6 1 1 1 1 1;}
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Cambria;
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:Tahoma;
	panose-1:2 11 6 4 3 5 4 4 2 4;}
@font-face
	{font-family:微软雅黑;
	panose-1:2 11 5 3 2 2 4 2 2 4;}
@font-face
	{font-family:Consolas;
	panose-1:2 11 6 9 2 2 4 3 2 4;}
@font-face
	{font-family:"\@微软雅黑";
	panose-1:2 11 5 3 2 2 4 2 2 4;}
@font-face
	{font-family:"\@宋体";
	panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
	{font-family:"\@黑体";
	panose-1:2 1 6 9 6 1 1 1 1 1;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:10.0pt;
	margin-left:0cm;
	layout-grid-mode:char;
	font-size:11.0pt;
	font-family:"Tahoma","sans-serif";}
h1
	{mso-style-link:"标题 1 Char";
	margin-top:17.0pt;
	margin-right:0cm;
	margin-bottom:16.5pt;
	margin-left:0cm;
	line-height:240%;
	page-break-after:avoid;
	layout-grid-mode:char;
	font-size:26.0pt;
	font-family:"Tahoma","sans-serif";
	font-weight:bold;}
h2
	{mso-style-link:"标题 2 Char";
	margin-top:13.0pt;
	margin-right:0cm;
	margin-bottom:13.0pt;
	margin-left:0cm;
	line-height:173%;
	page-break-after:avoid;
	layout-grid-mode:char;
	font-size:22.0pt;
	font-family:"Cambria","serif";
	font-weight:bold;}
h3
	{mso-style-link:"标题 3 Char";
	margin-top:13.0pt;
	margin-right:0cm;
	margin-bottom:13.0pt;
	margin-left:0cm;
	line-height:173%;
	page-break-after:avoid;
	layout-grid-mode:char;
	font-size:14.0pt;
	font-family:"Tahoma","sans-serif";
	font-weight:bold;}
h4
	{mso-style-link:"标题 4 Char";
	margin-top:14.0pt;
	margin-right:0cm;
	margin-bottom:14.5pt;
	margin-left:0cm;
	line-height:156%;
	page-break-after:avoid;
	layout-grid-mode:char;
	font-size:14.0pt;
	font-family:"Cambria","serif";
	font-weight:bold;}
h5
	{mso-style-link:"标题 5 Char";
	margin-top:14.0pt;
	margin-right:0cm;
	margin-bottom:14.5pt;
	margin-left:0cm;
	line-height:156%;
	page-break-after:avoid;
	layout-grid-mode:char;
	font-size:14.0pt;
	font-family:"Tahoma","sans-serif";
	font-weight:bold;}
h6
	{mso-style-link:"标题 6 Char";
	margin-top:12.0pt;
	margin-right:0cm;
	margin-bottom:3.2pt;
	margin-left:0cm;
	line-height:133%;
	page-break-after:avoid;
	layout-grid-mode:char;
	font-size:12.0pt;
	font-family:"Cambria","serif";
	font-weight:bold;}
p.MsoToc1, li.MsoToc1, div.MsoToc1
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:10.0pt;
	margin-left:0cm;
	layout-grid-mode:char;
	font-size:11.0pt;
	font-family:"Tahoma","sans-serif";}
p.MsoToc2, li.MsoToc2, div.MsoToc2
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:10.0pt;
	margin-left:21.0pt;
	layout-grid-mode:char;
	font-size:11.0pt;
	font-family:"Tahoma","sans-serif";}
p.MsoToc3, li.MsoToc3, div.MsoToc3
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:10.0pt;
	margin-left:42.0pt;
	layout-grid-mode:char;
	font-size:11.0pt;
	font-family:"Tahoma","sans-serif";}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;}
p
	{margin-right:0cm;
	margin-left:0cm;
	font-size:12.0pt;
	font-family:宋体;}
code
	{font-family:宋体;}
pre
	{mso-style-link:"HTML 预设格式 Char";
	margin:0cm;
	margin-bottom:.0001pt;
	font-size:12.0pt;
	font-family:宋体;}
p.MsoAcetate, li.MsoAcetate, div.MsoAcetate
	{mso-style-link:"批注框文本 Char";
	margin:0cm;
	margin-bottom:.0001pt;
	layout-grid-mode:char;
	font-size:9.0pt;
	font-family:"Tahoma","sans-serif";}
p.MsoTocHeading, li.MsoTocHeading, div.MsoTocHeading
	{margin-top:24.0pt;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:0cm;
	margin-bottom:.0001pt;
	line-height:115%;
	page-break-after:avoid;
	font-size:14.0pt;
	font-family:"Cambria","serif";
	color:#365F91;
	font-weight:bold;}
span.1Char
	{mso-style-name:"标题 1 Char";
	mso-style-link:"标题 1";
	font-family:"Tahoma","sans-serif";
	font-weight:bold;}
span.Char
	{mso-style-name:"批注框文本 Char";
	mso-style-link:批注框文本;
	font-family:"Tahoma","sans-serif";}
span.2Char
	{mso-style-name:"标题 2 Char";
	mso-style-link:"标题 2";
	font-family:"Cambria","serif";
	font-weight:bold;}
span.4Char
	{mso-style-name:"标题 4 Char";
	mso-style-link:"标题 4";
	font-family:"Cambria","serif";
	font-weight:bold;}
span.6Char
	{mso-style-name:"标题 6 Char";
	mso-style-link:"标题 6";
	font-family:"Cambria","serif";
	font-weight:bold;}
span.HTMLChar
	{mso-style-name:"HTML 预设格式 Char";
	mso-style-link:"HTML 预设格式";
	font-family:宋体;}
span.line
	{mso-style-name:line;}
span.hljs-operator
	{mso-style-name:hljs-operator;}
span.hljs-keyword
	{mso-style-name:hljs-keyword;}
span.hljs-number
	{mso-style-name:hljs-number;}
span.hljs-symbol
	{mso-style-name:hljs-symbol;}
span.hljs-regexp
	{mso-style-name:hljs-regexp;}
span.hljs-variable
	{mso-style-name:hljs-variable;}
span.hljs-input
	{mso-style-name:hljs-input;}
span.hljs-prompt
	{mso-style-name:hljs-prompt;}
span.hljs-builtin
	{mso-style-name:hljs-built_in;}
span.hljs-subst
	{mso-style-name:hljs-subst;}
span.hljs-attribute
	{mso-style-name:hljs-attribute;}
span.hljs-literal
	{mso-style-name:hljs-literal;}
span.hljs-comment
	{mso-style-name:hljs-comment;}
span.hljs-string
	{mso-style-name:hljs-string;}
span.5Char
	{mso-style-name:"标题 5 Char";
	mso-style-link:"标题 5";
	font-family:"Tahoma","sans-serif";
	font-weight:bold;}
span.haml
	{mso-style-name:haml;}
span.ruby
	{mso-style-name:ruby;}
span.3Char
	{mso-style-name:"标题 3 Char";
	mso-style-link:"标题 3";
	font-family:"Tahoma","sans-serif";
	font-weight:bold;}
span.hljs-annotation
	{mso-style-name:hljs-annotation;}
span.hljs-filename
	{mso-style-name:hljs-filename;}
span.hljs-value
	{mso-style-name:hljs-value;}
span.hljs-shebang
	{mso-style-name:hljs-shebang;}
span.pull-right
	{mso-style-name:pull-right;}
span.apple-converted-space
	{mso-style-name:apple-converted-space;}
.MsoChpDefault
	{font-size:11.0pt;}
.MsoPapDefault
	{margin-bottom:10.0pt;
	line-height:11.0pt;}
 /* Page Definitions */
 @page WordSection1
	{size:595.3pt 841.9pt;
	margin:36.0pt 36.0pt 36.0pt 36.0pt;}
div.WordSection1
	{page:WordSection1;}
 /* List Definitions */
 ol
	{margin-bottom:0cm;}
ul
	{margin-bottom:0cm;}
-->
</style>

</head>

<body lang=ZH-CN link=blue vlink=purple>

<div class=WordSection1>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoTocHeading align=center style='text-align:center'><span
class=1Char><span style='font-size:26.0pt;line-height:115%;font-family:宋体;
font-weight:normal'>目录</span></span></p>

<p class=MsoToc1><span lang=EN-US><a href="#_Toc416884138">elk<span lang=EN-US
style='font-family:"微软雅黑","sans-serif"'><span lang=EN-US>日志分析系统介绍与运维相关记录文档</span></span><span
style='color:windowtext;display:none;text-decoration:none'>.. </span><span
style='color:windowtext;display:none;text-decoration:none'>2</span></a></span></p>

<p class=MsoToc2 style='margin-left:22.0pt'><span lang=EN-US><a
href="#_Toc416884139"><span lang=EN-US style='font-family:"微软雅黑","sans-serif"'><span
lang=EN-US>日志分析系统整体架构</span></span><span style='color:windowtext;display:none;
text-decoration:none'>.. </span><span
style='color:windowtext;display:none;text-decoration:none'>2</span></a></span></p>

<p class=MsoToc2 style='margin-left:22.0pt'><span lang=EN-US><a
href="#_Toc416884140">Kafka<span lang=EN-US style='font-family:"微软雅黑","sans-serif"'><span
lang=EN-US>子系统简介</span></span><span style='color:windowtext;display:none;
text-decoration:none'>.. </span><span
style='color:windowtext;display:none;text-decoration:none'>3</span></a></span></p>

<p class=MsoToc3 style='margin-left:44.0pt'><span lang=EN-US><a
href="#_Toc416884141">Kafka<span lang=EN-US style='font-family:"微软雅黑","sans-serif"'><span
lang=EN-US>架构</span></span><span style='color:windowtext;display:none;
text-decoration:none'>.. </span><span
style='color:windowtext;display:none;text-decoration:none'>3</span></a></span></p>

<p class=MsoToc3 style='margin-left:44.0pt'><span lang=EN-US><a
href="#_Toc416884142">kafka<span lang=EN-US style='font-family:"微软雅黑","sans-serif"'><span
lang=EN-US>集群安装</span></span><span style='color:windowtext;display:none;
text-decoration:none'>.. </span><span
style='color:windowtext;display:none;text-decoration:none'>4</span></a></span></p>

<p class=MsoToc2 style='margin-left:22.0pt'><span lang=EN-US><a
href="#_Toc416884143">Storm<span lang=EN-US style='font-family:"微软雅黑","sans-serif"'><span
lang=EN-US>子系统简介</span></span><span style='color:windowtext;display:none;
text-decoration:none'>.. </span><span
style='color:windowtext;display:none;text-decoration:none'>6</span></a></span></p>

<p class=MsoToc3 style='margin-left:44.0pt'><span lang=EN-US><a
href="#_Toc416884144">Storm<span lang=EN-US style='font-family:"微软雅黑","sans-serif"'><span
lang=EN-US>组件说明</span></span><span style='color:windowtext;display:none;
text-decoration:none'>.. </span><span
style='color:windowtext;display:none;text-decoration:none'>6</span></a></span></p>

<p class=MsoToc3 style='margin-left:44.0pt'><span lang=EN-US><a
href="#_Toc416884145"><span lang=EN-US style='font-family:"微软雅黑","sans-serif"'><span
lang=EN-US>安装</span></span>storm<span style='color:windowtext;display:none;
text-decoration:none'>.. </span><span
style='color:windowtext;display:none;text-decoration:none'>8</span></a></span></p>

<p class=MsoToc2 style='margin-left:22.0pt'><span lang=EN-US><a
href="#_Toc416884146">Elasticsearch<span lang=EN-US style='font-family:"微软雅黑","sans-serif"'><span
lang=EN-US>子系统简介</span></span><span style='color:windowtext;display:none;
text-decoration:none'>.. </span><span
style='color:windowtext;display:none;text-decoration:none'>9</span></a></span></p>

<p class=MsoToc3 style='margin-left:44.0pt'><span lang=EN-US><a
href="#_Toc416884147">Elasticsearch <span lang=EN-US style='font-family:"微软雅黑","sans-serif"'><span
lang=EN-US>的分布式</span></span><span style='color:windowtext;display:none;
text-decoration:none'>.. </span><span
style='color:windowtext;display:none;text-decoration:none'>10</span></a></span></p>

<p class=MsoToc3 style='margin-left:44.0pt'><span lang=EN-US><a
href="#_Toc416884148"><span lang=EN-US style='font-family:"微软雅黑","sans-serif"'><span
lang=EN-US>安装</span></span> Elasticsearch<span style='color:windowtext;
display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>10</span></a></span></p>

<p class=MsoToc3 style='margin-left:44.0pt'><span lang=EN-US><a
href="#_Toc416884149"><span lang=EN-US style='font-family:"微软雅黑","sans-serif"'><span
lang=EN-US>运行</span></span> Elasticsearch<span style='color:windowtext;
display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>10</span></a></span></p>

<p class=MsoToc3 style='margin-left:44.0pt'><span lang=EN-US><a
href="#_Toc416884150">elastic<span lang=EN-US style='font-family:"微软雅黑","sans-serif"'><span
lang=EN-US>集群</span></span><span style='color:windowtext;display:none;
text-decoration:none'>.. </span><span
style='color:windowtext;display:none;text-decoration:none'>11</span></a></span></p>

<p class=MsoToc3 style='margin-left:44.0pt'><span lang=EN-US><a
href="#_Toc416884151">elastic <span lang=EN-US style='font-family:"微软雅黑","sans-serif"'><span
lang=EN-US>权限控制</span></span><span style='color:windowtext;display:none;
text-decoration:none'>.. </span><span
style='color:windowtext;display:none;text-decoration:none'>12</span></a></span></p>

<p class=MsoToc3 style='margin-left:44.0pt'><span lang=EN-US><a
href="#_Toc416884152">elastic<span lang=EN-US style='font-family:"微软雅黑","sans-serif"'><span
lang=EN-US>的备份</span></span><span style='color:windowtext;display:none;
text-decoration:none'>.. </span><span
style='color:windowtext;display:none;text-decoration:none'>15</span></a></span></p>

<p class=MsoToc2 style='margin-left:22.0pt'><span lang=EN-US><a
href="#_Toc416884153">Kafka<span lang=EN-US style='font-family:"微软雅黑","sans-serif"'><span
lang=EN-US>子系统简介</span></span><span style='color:windowtext;display:none;
text-decoration:none'>.. </span><span
style='color:windowtext;display:none;text-decoration:none'>16</span></a></span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<h1 align=center style='text-align:center'><a name="_Toc416884138"><span
lang=EN-US>ELK</span></a><span style='font-family:"微软雅黑","sans-serif"'>日志分析系统介绍与运维相关记录文档</span></h1>

<h2><a name="_Toc416884139"><span style='font-family:黑体'>日志分析系统整体架构</span></a></h2>

<p class=MsoNormal><span lang=EN-US><img width=553 height=499 id="图片 1"
src="2015-03-15-ELK日志分析系统.files/image001.gif" alt=上报流程图></span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<h2><a name="_Toc416884140"><span lang=EN-US>Kafka</span></a><span
style='font-family:黑体'>子系统简介</span></h2>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:6.75pt;margin-left:
0cm;;'><span lang=EN-US style='font-size:
10.5pt;font-family:"Helvetica","sans-serif";color:#333333'>Kafka</span><span
style='font-size:10.5pt;color:#333333'>是一种分布式的，基于发布</span><span lang=EN-US
style='font-size:10.5pt;font-family:"Helvetica","sans-serif";color:#333333'>/</span><span
style='font-size:10.5pt;color:#333333'>订阅的消息系统。主要设计目标如下：</span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:6.75pt;margin-left:
0cm;;'><span style='font-size:10.5pt;
color:#333333'>以时间复杂度为</span><span lang=EN-US style='font-size:10.5pt;
font-family:"Helvetica","sans-serif";color:#333333'>O(1)</span><span
style='font-size:10.5pt;color:#333333'>的方式提供消息持久化能力，即使对</span><span lang=EN-US
style='font-size:10.5pt;font-family:"Helvetica","sans-serif";color:#333333'>TB</span><span
style='font-size:10.5pt;color:#333333'>级以上数据也能保证常数时间的访问性能</span><span
style='font-size:10.5pt;font-family:"Helvetica","sans-serif";color:#333333'> </span><span
style='font-size:10.5pt;color:#333333'>高吞吐率。即使在非常廉价的商用机器上也能做到单机支持每秒</span><span
lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif";
color:#333333'>100K</span><span style='font-size:10.5pt;color:#333333'>条消息的传输</span><span
style='font-size:10.5pt;font-family:"Helvetica","sans-serif";color:#333333'> </span><span
style='font-size:10.5pt;color:#333333'>支持</span><span lang=EN-US
style='font-size:10.5pt;font-family:"Helvetica","sans-serif";color:#333333'>Kafka
Server</span><span style='font-size:10.5pt;color:#333333'>间的消息分区，及分布式消费，同时保证每个</span><span
lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif";
color:#333333'>partition</span><span style='font-size:10.5pt;color:#333333'>内的消息顺序传输</span><span
style='font-size:10.5pt;font-family:"Helvetica","sans-serif";color:#333333'> </span><span
style='font-size:10.5pt;color:#333333'>同时支持离线数据处理和实时数据处理</span></p>

<h3><a name="_Toc416884141"><span lang=EN-US>Kafka</span></a><span
style='font-family:宋体'>架构</span></h3>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:6.75pt;margin-left:
0cm;;'><span lang=EN-US style='font-size:
10.5pt;font-family:"Helvetica","sans-serif";color:#333333'><img width=645
height=300 id="图片 4" src="2015-03-15-ELK日志分析系统.files/image002.jpg" alt=kafka></span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:6.75pt;margin-left:
0cm;;'><span lang=EN-US style='font-size:
10.5pt;font-family:"Helvetica","sans-serif";color:#333333'>Kafka</span><span
style='font-size:10.5pt;color:#333333'>的整体架构非常简单，是显式分布式架构，</span><span
lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif";
color:#333333'>producer</span><span style='font-size:10.5pt;color:#333333'>、</span><span
lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif";
color:#333333'>broker</span><span style='font-size:10.5pt;color:#333333'>（</span><span
lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif";
color:#333333'>kafka</span><span style='font-size:10.5pt;color:#333333'>）和</span><span
lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif";
color:#333333'>consumer</span><span style='font-size:10.5pt;color:#333333'>都可以有多个。</span><span
lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif";
color:#333333'>Producer</span><span style='font-size:10.5pt;color:#333333'>，</span><span
lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif";
color:#333333'>consumer</span><span style='font-size:10.5pt;color:#333333'>实现</span><span
lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif";
color:#333333'>Kafka</span><span style='font-size:10.5pt;color:#333333'>注册的接口，数据从</span><span
lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif";
color:#333333'>producer</span><span style='font-size:10.5pt;color:#333333'>发送到</span><span
lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif";
color:#333333'>broker</span><span style='font-size:10.5pt;color:#333333'>，</span><span
lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif";
color:#333333'>broker</span><span style='font-size:10.5pt;color:#333333'>承担一个中间缓存和分发的作用。</span><span
lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif";
color:#333333'>broker</span><span style='font-size:10.5pt;color:#333333'>分发注册到系统中的</span><span
lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif";
color:#333333'>consumer</span><span style='font-size:10.5pt;color:#333333'>。</span><span
lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif";
color:#333333'>broker</span><span style='font-size:10.5pt;color:#333333'>的作用类似于缓存，即活跃的数据和离线处理系统之间的缓存。客户端和服务器端的通信，是基于简单，高性能，且与编程语言无关的</span><span
lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif";
color:#333333'>TCP</span><span style='font-size:10.5pt;color:#333333'>协议。几个基本概念：</span></p>

<ol style='margin-top:0cm' start=1 type=1>
 <li class=MsoNormal style='color:#333333;layout-grid-mode:both;'><span lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>Topic</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>：特指</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>Kafka</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>处理的消息源（</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>feeds
     of messages</span><span style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>）的不同分类。</span></li>
 <li class=MsoNormal style='color:#333333;layout-grid-mode:both;'><span lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>Partition</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>：</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>Topic</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>物理上的分组，一个</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>topic</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>可以分为多个</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>partition</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>，每个</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>partition</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>是一个有序的队列。</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>partition</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>中的每条消息都会被分配一个有序的</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>id</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>（</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>offset</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>）。</span></li>
 <li class=MsoNormal style='color:#333333;layout-grid-mode:both;'><span lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>Message</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>：消息，是通信的基本单位，每个</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>producer</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>可以向一个</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>topic</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>（主题）发布一些消息。</span></li>
 <li class=MsoNormal style='color:#333333;layout-grid-mode:both;'><span lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>Producers</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>：消息和数据生产者，向</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>Kafka</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>的一个</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>topic</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>发布消息的过程叫做</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>producers</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>。</span></li>
 <li class=MsoNormal style='color:#333333;layout-grid-mode:both;'><span lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>Consumers</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>：消息和数据消费者，订阅</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>topics</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>并处理其发布的消息的过程叫做</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>consumers</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>。</span></li>
 <li class=MsoNormal style='color:#333333;layout-grid-mode:both;'><span lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>Broker</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>：缓存代理，</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>Kafka</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>集群中的一台或多台服务器统称为</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>broker</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>。</span></li>
</ol>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:6.75pt;margin-left:
0cm;;'><span style='font-size:10.5pt;
color:#333333'>消息发送的流程：</span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:6.75pt;margin-left:
0cm;;'><span lang=EN-US style='font-size:
10.5pt;font-family:"Helvetica","sans-serif";color:#333333'><img width=587
height=325 id="图片 5" src="2015-03-15-ELK日志分析系统.files/image003.jpg"
alt="kafka_up"></span></p>

<ol style='margin-top:0cm' start=1 type=1>
 <li class=MsoNormal style='color:#333333;layout-grid-mode:both;'><span lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>Producer</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>根据指定的</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>partition</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>方法（</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>round-robin</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>、</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>hash</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>等），将消息发布到指定</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>topic</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>的</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>partition</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>里面</span></li>
 <li class=MsoNormal style='color:#333333;layout-grid-mode:both;'><span lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>kafka</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>集群接收到</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>Producer</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>发过来的消息后，将其持久化到硬盘，并保留消息指定时长（可配置），而不关注消息是否被消费。</span></li>
 <li class=MsoNormal style='color:#333333;layout-grid-mode:both;'><span lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>Consumer</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>从</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>kafka</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>集群</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>pull</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>数据，并控制获取消息的</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>offset</span></li>
</ol>

<p class=MsoNormal style='layout-grid-mode:both;'><span
lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif";
color:#333333'>&nbsp;</span></p>

<h3><a name="_Toc416884142"><span lang=EN-US>kafka</span></a><span
style='font-family:宋体'>集群安装</span></h3>

<h6 style='margin-top:0cm;margin-right:0cm;margin-bottom:6.75pt;margin-left:
0cm;'><span lang=EN-US style='font-size:9.0pt;line-height:133%;
font-family:"Helvetica","sans-serif";color:#888888;text-transform:uppercase;
font-weight:normal'>JAVA</span><span style='font-size:9.0pt;line-height:133%;
font-family:宋体;color:#888888;text-transform:uppercase;font-weight:normal'>环境</span></h6>

<pre style=';;'><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'>yum </span></span><span class=hljs-keyword><b><span lang=EN-US
style='font-family:Consolas;color:#AA0D91;'>install</span></b></span><span
class=hljs-operator><span lang=EN-US style='font-family:Consolas;color:black;
'> java-</span></span><span class=hljs-number><span lang=EN-US
style='font-family:Consolas;color:#1C00CF;'>1.7.0</span></span><span
class=hljs-operator><span lang=EN-US style='font-family:Consolas;color:black;
'>-openjdk-devel</span></span></pre><pre style='line-height:
16.8pt;;'><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'>&nbsp;</span></span></pre>

<h6 style='margin-top:0cm;margin-right:0cm;margin-bottom:6.75pt;margin-left:
0cm;'><span lang=EN-US style='font-size:9.0pt;line-height:133%;
font-family:"Helvetica","sans-serif";color:#888888;text-transform:uppercase;
font-weight:normal'>ZOOKEEPER</span><span style='font-size:9.0pt;line-height:
133%;font-family:宋体;color:#888888;text-transform:uppercase;font-weight:normal'>安装配置：</span></h6>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:6.75pt;margin-left:
0cm;;'><b><span style='font-size:10.5pt;
color:#333333'>下载最新版</span></b></p>

<pre style=';;'><span
class=hljs-symbol><span lang=EN-US style='font-family:Consolas;color:#1C00CF;
'>http:</span></span><span class=line><span lang=EN-US
style='font-family:Consolas;color:black;'>/</span></span><span
class=hljs-regexp><span lang=EN-US style='font-family:Consolas;color:#008800;
'>/mirrors.cnnic.cn/apache/zookeeper/zookeeper</span></span><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'>-</span></span><span class=hljs-number><span lang=EN-US
style='font-family:Consolas;color:#1C00CF;'>3.4</span></span><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'>.</span></span><span class=hljs-number><span lang=EN-US
style='font-family:Consolas;color:#1C00CF;'>6</span></span><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'>/zookeeper-</span></span><span class=hljs-number><span lang=EN-US
style='font-family:Consolas;color:#1C00CF;'>3.4</span></span><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'>.</span></span><span class=hljs-number><span lang=EN-US
style='font-family:Consolas;color:#1C00CF;'>6</span></span><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'>.tar.gz</span></span></pre><pre style=';;'><code><span lang=EN-US style='font-family:Consolas;
color:black;'>&nbsp;</span></code></pre>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:6.75pt;margin-left:
0cm;;'><b><span style='font-size:10.5pt;
color:#333333'>解压，进入目录</span></b></p>

<pre style=';;'><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'>zookeeper-</span></span><span class=hljs-number><span lang=EN-US
style='font-family:Consolas;color:#1C00CF;'>3.4</span></span><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'>.</span></span><span class=hljs-number><span lang=EN-US
style='font-family:Consolas;color:#1C00CF;'>6</span></span><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'>/</span></span><span class=hljs-keyword><b><span lang=EN-US
style='font-family:Consolas;color:#AA0D91;'>conf</span></b></span></pre><pre
style=';;'><span
class=hljs-keyword><b><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>cp</span></b></span><span class=line><span lang=EN-US
style='font-family:Consolas;color:black;'> zoo_sample.cfg zoo.cfg </span></span></pre><pre
style=';;'><code><span
lang=EN-US style='font-family:Consolas;color:black;'>&nbsp;</span></code></pre>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:6.75pt;margin-left:
0cm;;'><b><span style='font-size:10.5pt;
color:#333333'>配置如下：</span></b></p>

<pre style=';;'><span
class=hljs-variable><span lang=EN-US style='font-family:Consolas;color:#3F6E74;
'>tickTime=</span></span><span class=hljs-number><span
lang=EN-US style='font-family:Consolas;color:#1C00CF;'>2000</span></span></pre><pre
style=';;'><span
class=hljs-variable><span lang=EN-US style='font-family:Consolas;color:#3F6E74;
'>initLimit=</span></span><span class=hljs-number><span
lang=EN-US style='font-family:Consolas;color:#1C00CF;'>10</span></span></pre><pre
style=';;'><span
class=hljs-variable><span lang=EN-US style='font-family:Consolas;color:#3F6E74;
'>syncLimit=</span></span><span class=hljs-number><span
lang=EN-US style='font-family:Consolas;color:#1C00CF;'>5</span></span></pre><pre
style=';;'><span
class=hljs-variable><span lang=EN-US style='font-family:Consolas;color:#3F6E74;
'>dataDir=</span></span><span class=line><span lang=EN-US
style='font-family:Consolas;color:black;'>/home/zookeeper/data</span></span></pre><pre
style=';;'><span
class=hljs-variable><span lang=EN-US style='font-family:Consolas;color:#3F6E74;
'>clientPort=</span></span><span class=hljs-number><span
lang=EN-US style='font-family:Consolas;color:#1C00CF;'>2181</span></span></pre><pre
style=';;'><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'>server.</span></span><span class=hljs-number><span lang=EN-US
style='font-family:Consolas;color:#1C00CF;'>1</span></span><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'>=</span></span><span class=hljs-number><span lang=EN-US
style='font-family:Consolas;color:#1C00CF;'>10.104</span></span><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'>.</span></span><span class=hljs-number><span lang=EN-US
style='font-family:Consolas;color:#1C00CF;'>23.206</span></span><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'>:</span></span><span class=hljs-number><span lang=EN-US
style='font-family:Consolas;color:#1C00CF;'>2888</span></span><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'>:</span></span><span class=hljs-number><span lang=EN-US
style='font-family:Consolas;color:#1C00CF;'>2999</span></span><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'> </span></span></pre><pre style=';;
'><span class=line><span lang=EN-US style='font-family:
Consolas;color:black;'>server.</span></span><span
class=hljs-number><span lang=EN-US style='font-family:Consolas;color:#1C00CF;
'>2</span></span><span class=line><span lang=EN-US
style='font-family:Consolas;color:black;'>=</span></span><span
class=hljs-number><span lang=EN-US style='font-family:Consolas;color:#1C00CF;
'>10.104</span></span><span class=line><span lang=EN-US
style='font-family:Consolas;color:black;'>.</span></span><span
class=hljs-number><span lang=EN-US style='font-family:Consolas;color:#1C00CF;
'>23.207</span></span><span class=line><span lang=EN-US
style='font-family:Consolas;color:black;'>:</span></span><span
class=hljs-number><span lang=EN-US style='font-family:Consolas;color:#1C00CF;
'>2888</span></span><span class=line><span lang=EN-US
style='font-family:Consolas;color:black;'>:</span></span><span
class=hljs-number><span lang=EN-US style='font-family:Consolas;color:#1C00CF;
'>2999</span></span><span class=line><span lang=EN-US
style='font-family:Consolas;color:black;'> </span></span></pre><pre
style=';;'><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'>server.</span></span><span class=hljs-number><span lang=EN-US
style='font-family:Consolas;color:#1C00CF;'>3</span></span><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'>=</span></span><span class=hljs-number><span lang=EN-US
style='font-family:Consolas;color:#1C00CF;'>10.251</span></span><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'>.</span></span><span class=hljs-number><span lang=EN-US
style='font-family:Consolas;color:#1C00CF;'>169.57</span></span><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'>:</span></span><span class=hljs-number><span lang=EN-US
style='font-family:Consolas;color:#1C00CF;'>2888</span></span><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'>:</span></span><span class=hljs-number><span lang=EN-US
style='font-family:Consolas;color:#1C00CF;'>2999</span></span><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'> </span></span></pre><pre style=';;
'><code><span lang=EN-US style='font-family:Consolas;
color:black;'>&nbsp;</span></code></pre>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:6.75pt;margin-left:
0cm;;'><b><span style='font-size:10.5pt;
color:#333333'>在各自机器上</span></b><b><span lang=EN-US style='font-size:10.5pt;
font-family:"Helvetica","sans-serif";color:#333333'>dataDir</span></b><b><span
style='font-size:10.5pt;color:#333333'>目录下添加</span></b><b><span lang=EN-US
style='font-size:10.5pt;font-family:"Helvetica","sans-serif";color:#333333'>myid
</span></b><b><span style='font-size:10.5pt;color:#333333'>如：</span></b><b><span
lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif";
color:#333333'>server.2</span></b><b><span style='font-size:10.5pt;color:#333333'>上输入</span></b></p>

<pre style=';;'><span
class=hljs-prompt><span lang=EN-US style='font-family:Consolas;color:#1C00CF;
'>echo 2 &gt;</span></span><span class=hljs-input><span
lang=EN-US style='font-family:Consolas;color:black;'> /home/zookeeper/data/myid</span></span></pre><pre
style=';;'><code><span
lang=EN-US style='font-family:Consolas;color:black;'>&nbsp;</span></code></pre>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:6.75pt;margin-left:
0cm;;'><b><span style='font-size:10.5pt;
color:#333333'>配置</span></b><b><span lang=EN-US style='font-size:10.5pt;
font-family:"Helvetica","sans-serif";color:#333333'>zookeeper</span></b><b><span
style='font-size:10.5pt;color:#333333'>日志</span></b></p>

<pre style=';;'><span
class=line><span style='color:black;'>在</span></span><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'>zkEnv</span></span><span class=hljs-builtin><b><span lang=EN-US
style='font-family:Consolas;color:#5C2699;'>.</span></b></span><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'>sh</span></span><span class=line><span style='color:black;'>中添加</span></span></pre><pre style=';;
'><span class=line><span lang=EN-US style='font-family:
Consolas;color:black;'>ZOO_LOG_DIR</span></span><span
class=hljs-subst><span lang=EN-US style='font-family:Consolas;color:black;
'>=</span></span><span class=line><span lang=EN-US
style='font-family:Consolas;color:black;'>/</span></span><span
class=hljs-builtin><b><span lang=EN-US style='font-family:Consolas;color:#5C2699;
'>var</span></b></span><span class=line><span lang=EN-US
style='font-family:Consolas;color:black;'>/</span></span><span
class=hljs-keyword><b><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>log</span></b></span><span class=line><span lang=EN-US
style='font-family:Consolas;color:black;'>/zookeeper</span></span></pre><pre
style=';;'><code><span
lang=EN-US style='font-family:Consolas;color:black;'>&nbsp;</span></code></pre><pre
style=';;'><span
class=line><span style='color:black;'>修改</span></span><span
class=hljs-builtin><b><span lang=EN-US style='font-family:Consolas;color:#5C2699;
'>..</span></b></span><span class=line><span lang=EN-US
style='font-family:Consolas;color:black;'>/conf/log4j</span></span><span
class=hljs-builtin><b><span lang=EN-US style='font-family:Consolas;color:#5C2699;
'>.</span></b></span><span class=line><span lang=EN-US
style='font-family:Consolas;color:black;'>properties</span></span></pre><pre
style=';;'><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'>zookeeper</span></span><span class=hljs-builtin><b><span lang=EN-US
style='font-family:Consolas;color:#5C2699;'>.</span></b></span><span
class=hljs-keyword><b><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>log</span></b></span><span class=hljs-builtin><b><span
lang=EN-US style='font-family:Consolas;color:#5C2699;'>.</span></b></span><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'>dir</span></span><span class=hljs-subst><span lang=EN-US
style='font-family:Consolas;color:black;'>=</span></span><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'>/</span></span><span class=hljs-builtin><b><span lang=EN-US
style='font-family:Consolas;color:#5C2699;'>var</span></b></span><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'>/</span></span><span class=hljs-keyword><b><span lang=EN-US
style='font-family:Consolas;color:#AA0D91;'>log</span></b></span><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'>/zookeeper</span></span></pre><pre style=';;'><span class=line><span lang=EN-US style='font-family:
Consolas;color:black;'>zookeeper</span></span><span
class=hljs-builtin><b><span lang=EN-US style='font-family:Consolas;color:#5C2699;
'>.</span></b></span><span class=line><span lang=EN-US
style='font-family:Consolas;color:black;'>tracelog</span></span><span
class=hljs-builtin><b><span lang=EN-US style='font-family:Consolas;color:#5C2699;
'>.</span></b></span><span class=line><span lang=EN-US
style='font-family:Consolas;color:black;'>dir</span></span><span
class=hljs-subst><span lang=EN-US style='font-family:Consolas;color:black;
'>=</span></span><span class=line><span lang=EN-US
style='font-family:Consolas;color:black;'>/</span></span><span
class=hljs-builtin><b><span lang=EN-US style='font-family:Consolas;color:#5C2699;
'>var</span></b></span><span class=line><span lang=EN-US
style='font-family:Consolas;color:black;'>/</span></span><span
class=hljs-keyword><b><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>log</span></b></span><span class=line><span lang=EN-US
style='font-family:Consolas;color:black;'>/zookeeper</span></span></pre><pre
style=';;'><code><span
lang=EN-US style='font-family:Consolas;color:black;'>&nbsp;</span></code></pre><pre
style=';;'><span
class=line><span style='color:black;'>注释掉：</span></span></pre><pre
style=';;'><span
class=hljs-variable><span lang=EN-US style='font-family:Consolas;color:#3F6E74;
'>#log4j.rootLogger</span></span><span class=hljs-subst><span
lang=EN-US style='font-family:Consolas;color:black;'>=</span></span><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'>${zookeeper</span></span><span class=hljs-builtin><b><span lang=EN-US
style='font-family:Consolas;color:#5C2699;'>.</span></b></span><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'>root</span></span><span class=hljs-builtin><b><span lang=EN-US
style='font-family:Consolas;color:#5C2699;'>.</span></b></span><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'>logger}</span></span></pre><pre style=';;'><code><span lang=EN-US style='font-family:Consolas;
color:black;'>&nbsp;</span></code></pre><pre style='line-height:
16.8pt;;'><span class=line><span
style='color:black;'>去掉注释：</span></span></pre><pre
style=';;'><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'>log4j</span></span><span class=hljs-builtin><b><span lang=EN-US
style='font-family:Consolas;color:#5C2699;'>.</span></b></span><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'>rootLogger</span></span><span class=hljs-subst><span lang=EN-US
style='font-family:Consolas;color:black;'>=</span></span><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'>TRACE, CONSOLE, ROLLINGFILE, TRACEFILE</span></span></pre><pre
style=';;'><code><span
lang=EN-US style='font-family:Consolas;color:black;'>&nbsp;</span></code></pre><pre
style=';;'><span
class=line><span style='color:black;'>创建</span></span><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'>zookeeper</span></span><span class=line><span style='color:black;
'>日志目录</span></span><span class=line><span style='font-family:
Consolas;color:black;'> </span></span></pre><pre
style=';;'><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'>mkdir </span></span><span class=hljs-attribute><span lang=EN-US
style='font-family:Consolas;color:#8888FF;'>-p</span></span><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'> /</span></span><span class=hljs-builtin><b><span lang=EN-US
style='font-family:Consolas;color:#5C2699;'>var</span></b></span><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'>/</span></span><span class=hljs-keyword><b><span lang=EN-US
style='font-family:Consolas;color:#AA0D91;'>log</span></b></span><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'>/zookeeper</span></span><span class=hljs-subst><span lang=EN-US
style='font-family:Consolas;color:black;'>/</span></span><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'> </span></span></pre><pre style=';;
'><span class=line><span lang=EN-US style='font-family:
Consolas;color:black;'>chown </span></span><span
class=hljs-attribute><span lang=EN-US style='font-family:Consolas;color:#8888FF;
'>-R</span></span><span class=line><span lang=EN-US
style='font-family:Consolas;color:black;'> bot</span></span><span
class=hljs-builtin><b><span lang=EN-US style='font-family:Consolas;color:#5C2699;
'>.</span></b></span><span class=line><span lang=EN-US
style='font-family:Consolas;color:black;'>qbdev /</span></span><span
class=hljs-builtin><b><span lang=EN-US style='font-family:Consolas;color:#5C2699;
'>var</span></b></span><span class=line><span lang=EN-US
style='font-family:Consolas;color:black;'>/</span></span><span
class=hljs-keyword><b><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>log</span></b></span><span class=line><span lang=EN-US
style='font-family:Consolas;color:black;'>/zookeeper</span></span><span
class=hljs-subst><span lang=EN-US style='font-family:Consolas;color:black;
'>/</span></span></pre><pre style=';
;'><code><span lang=EN-US style='font-family:
Consolas;color:black;'>&nbsp;</span></code></pre><pre
style=';;'><code><span
lang=EN-US style='font-family:Consolas;color:black;'>&nbsp;</span></code></pre>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:6.75pt;margin-left:
0cm;;'><b><span style='color:#333333'>测试</span></b><b><span
lang=EN-US style='font-family:"Helvetica","sans-serif";color:#333333'>zookeeper</span></b></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:6.75pt;margin-left:
0cm;;'><span style='color:#333333'>进入</span><span
lang=EN-US style='font-family:"Helvetica","sans-serif";color:#333333'>
zookeeper/bin</span></p>

<pre style=';;'><span
class=line><span style='color:black;'>执行命令</span></span></pre><pre
style=';;'><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'>./zkCli.sh</span></span></pre><pre style=';;'><code><span lang=EN-US style='font-family:Consolas;
color:black;'>&nbsp;</span></code></pre><pre style='line-height:
16.8pt;;'><span class=line><span
lang=EN-US style='font-family:Consolas;color:black;'>[zk: localhost:</span></span><span
class=hljs-number><span lang=EN-US style='font-family:Consolas;color:#1C00CF;
'>2181</span></span><span class=line><span lang=EN-US
style='font-family:Consolas;color:black;'>(CONNECTED) </span></span><span
class=hljs-number><span lang=EN-US style='font-family:Consolas;color:#1C00CF;
'>0</span></span><span class=line><span lang=EN-US
style='font-family:Consolas;color:black;'>] ls /</span></span></pre><pre
style=';;'><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'>[</span></span><span class=hljs-literal><span lang=EN-US
style='font-family:Consolas;color:#AA0D91;'>admin</span></span><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'>, zookeeper, pyleus-kafka-offsets, consumers, config, controller, storm, brokers, controller_epoch]</span></span></pre><pre
style=';;'><code><span
lang=EN-US style='font-family:Consolas;color:black;'>&nbsp;</span></code></pre>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:6.75pt;margin-left:
0cm;;'><b><span lang=EN-US style='font-size:
10.5pt;font-family:"Helvetica","sans-serif";color:#333333'>zookeep</span></b><b><span
style='font-size:10.5pt;color:#333333'>完成，退出</span></b></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:6.75pt;margin-left:
0cm;;'><b><span lang=EN-US style='font-size:
10.5pt;font-family:"Helvetica","sans-serif";color:#333333'>&nbsp;</span></b></p>

<h6 style='margin-top:0cm;margin-right:0cm;margin-bottom:6.75pt;margin-left:
0cm;'><span style='font-size:9.0pt;line-height:133%;font-family:
宋体;color:#888888;text-transform:uppercase;font-weight:normal'>安装</span><span
lang=EN-US style='font-size:9.0pt;line-height:133%;font-family:"Helvetica","sans-serif";
color:#888888;text-transform:uppercase;font-weight:normal'>KAFKA</span></h6>

<pre style=';;'><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>wget</span></span><span class=line><span lang=EN-US
style='font-family:Consolas;color:black;'> </span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>https://www</span></span><span class=hljs-string><span
lang=EN-US style='font-family:Consolas;color:#C41A16;'>.</span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>apache</span></span><span class=hljs-string><span lang=EN-US
style='font-family:Consolas;color:#C41A16;'>.</span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>org/dyn/closer</span></span><span class=hljs-string><span
lang=EN-US style='font-family:Consolas;color:#C41A16;'>.</span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>cgi?path=/kafka/0</span></span><span class=hljs-string><span
lang=EN-US style='font-family:Consolas;color:#C41A16;'>.</span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>8</span></span><span class=hljs-string><span lang=EN-US
style='font-family:Consolas;color:#C41A16;'>.</span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>2</span></span><span class=hljs-string><span lang=EN-US
style='font-family:Consolas;color:#C41A16;'>.</span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>1/kafka</span></span><span class=hljs-literal><span
lang=EN-US style='font-family:Consolas;color:#AA0D91;'>-</span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>0</span></span><span class=hljs-string><span lang=EN-US
style='font-family:Consolas;color:#C41A16;'>.</span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>8</span></span><span class=hljs-string><span lang=EN-US
style='font-family:Consolas;color:#C41A16;'>.</span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>2</span></span><span class=hljs-string><span lang=EN-US
style='font-family:Consolas;color:#C41A16;'>.</span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>1</span></span><span class=hljs-literal><span lang=EN-US
style='font-family:Consolas;color:#AA0D91;'>-</span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>src</span></span><span class=hljs-string><span lang=EN-US
style='font-family:Consolas;color:#C41A16;'>.</span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>tgz</span></span></pre><pre style=';
;'><code><span lang=EN-US style='font-family:
Consolas;color:black;'>&nbsp;</span></code></pre><pre
style=';;'><span
class=hljs-comment><span style='color:#006A00;'>解压并修改配置：</span></span></pre><pre
style=';;'><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>config/server</span></span><span class=hljs-string><span
lang=EN-US style='font-family:Consolas;color:#C41A16;'>.</span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>properties</span></span></pre><pre style=';
;'><span class=hljs-comment><span
lang=EN-US style='font-family:Consolas;color:#006A00;'>zookeeper</span></span><span
class=hljs-string><span lang=EN-US style='font-family:Consolas;color:#C41A16;
'>.</span></span><span class=hljs-comment><span lang=EN-US
style='font-family:Consolas;color:#006A00;'>connect=10</span></span><span
class=hljs-string><span lang=EN-US style='font-family:Consolas;color:#C41A16;
'>.</span></span><span class=hljs-comment><span lang=EN-US
style='font-family:Consolas;color:#006A00;'>104</span></span><span
class=hljs-string><span lang=EN-US style='font-family:Consolas;color:#C41A16;
'>.</span></span><span class=hljs-comment><span lang=EN-US
style='font-family:Consolas;color:#006A00;'>23</span></span><span
class=hljs-string><span lang=EN-US style='font-family:Consolas;color:#C41A16;
'>.</span></span><span class=hljs-comment><span lang=EN-US
style='font-family:Consolas;color:#006A00;'>206:2181</span></span><span
class=hljs-string><span lang=EN-US style='font-family:Consolas;color:#C41A16;
'>,</span></span><span class=hljs-comment><span lang=EN-US
style='font-family:Consolas;color:#006A00;'>10</span></span><span
class=hljs-string><span lang=EN-US style='font-family:Consolas;color:#C41A16;
'>.</span></span><span class=hljs-comment><span lang=EN-US
style='font-family:Consolas;color:#006A00;'>104</span></span><span
class=hljs-string><span lang=EN-US style='font-family:Consolas;color:#C41A16;
'>.</span></span><span class=hljs-comment><span lang=EN-US
style='font-family:Consolas;color:#006A00;'>23</span></span><span
class=hljs-string><span lang=EN-US style='font-family:Consolas;color:#C41A16;
'>.</span></span><span class=hljs-comment><span lang=EN-US
style='font-family:Consolas;color:#006A00;'>207:2181</span></span><span
class=hljs-string><span lang=EN-US style='font-family:Consolas;color:#C41A16;
'>,</span></span><span class=hljs-comment><span lang=EN-US
style='font-family:Consolas;color:#006A00;'>10</span></span><span
class=hljs-string><span lang=EN-US style='font-family:Consolas;color:#C41A16;
'>.</span></span><span class=hljs-comment><span lang=EN-US
style='font-family:Consolas;color:#006A00;'>251</span></span><span
class=hljs-string><span lang=EN-US style='font-family:Consolas;color:#C41A16;
'>.</span></span><span class=hljs-comment><span lang=EN-US
style='font-family:Consolas;color:#006A00;'>169</span></span><span
class=hljs-string><span lang=EN-US style='font-family:Consolas;color:#C41A16;
'>.</span></span><span class=hljs-comment><span lang=EN-US
style='font-family:Consolas;color:#006A00;'>57:2181</span></span></pre><pre
style=';;'><code><span
lang=EN-US style='font-family:Consolas;color:black;'>&nbsp;</span></code></pre><pre
style=';;'><span
class=hljs-comment><span style='color:#006A00;'>创建</span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>topic</span></span><span class=hljs-comment><span
style='color:#006A00;'>测试</span></span></pre><pre
style=';;'><span
class=hljs-string><span lang=EN-US style='font-family:Consolas;color:#C41A16;
'>.</span></span><span class=hljs-comment><span lang=EN-US
style='font-family:Consolas;color:#006A00;'>/kafka</span></span><span
class=hljs-literal><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>-</span></span><span class=hljs-comment><span lang=EN-US
style='font-family:Consolas;color:#006A00;'>topics</span></span><span
class=hljs-string><span lang=EN-US style='font-family:Consolas;color:#C41A16;
'>.</span></span><span class=hljs-comment><span lang=EN-US
style='font-family:Consolas;color:#006A00;'>sh</span></span><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'> </span></span><span class=hljs-literal><span lang=EN-US
style='font-family:Consolas;color:#AA0D91;'>--</span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>create</span></span><span class=line><span lang=EN-US
style='font-family:Consolas;color:black;'> </span></span><span
class=hljs-literal><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>--</span></span><span class=hljs-comment><span lang=EN-US
style='font-family:Consolas;color:#006A00;'>zookeeper</span></span><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'> </span></span><span class=hljs-comment><span lang=EN-US
style='font-family:Consolas;color:#006A00;'>localhost:2181</span></span><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'> </span></span><span class=hljs-literal><span lang=EN-US
style='font-family:Consolas;color:#AA0D91;'>--</span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>replication</span></span><span class=hljs-literal><span
lang=EN-US style='font-family:Consolas;color:#AA0D91;'>-</span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>factor</span></span><span class=line><span lang=EN-US
style='font-family:Consolas;color:black;'> </span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>3</span></span><span class=line><span lang=EN-US
style='font-family:Consolas;color:black;'> </span></span><span
class=hljs-literal><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>--</span></span><span class=hljs-comment><span lang=EN-US
style='font-family:Consolas;color:#006A00;'>partitions</span></span><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'> </span></span><span class=hljs-comment><span lang=EN-US
style='font-family:Consolas;color:#006A00;'>3</span></span><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'> </span></span><span class=hljs-literal><span lang=EN-US
style='font-family:Consolas;color:#AA0D91;'>--</span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>topic</span></span><span class=line><span lang=EN-US
style='font-family:Consolas;color:black;'> </span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>my</span></span><span class=hljs-literal><span lang=EN-US
style='font-family:Consolas;color:#AA0D91;'>-</span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>replicated</span></span><span class=hljs-literal><span
lang=EN-US style='font-family:Consolas;color:#AA0D91;'>-</span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>topic</span></span></pre><pre style=';
;'><span class=hljs-comment><span
lang=EN-US style='font-family:Consolas;color:#006A00;'>Created</span></span><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'> </span></span><span class=hljs-comment><span lang=EN-US
style='font-family:Consolas;color:#006A00;'>topic</span></span><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'> </span></span><span class=hljs-comment><span lang=EN-US
style='font-family:Consolas;color:#006A00;'>&quot;my</span></span><span
class=hljs-literal><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>-</span></span><span class=hljs-comment><span lang=EN-US
style='font-family:Consolas;color:#006A00;'>replicated</span></span><span
class=hljs-literal><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>-</span></span><span class=hljs-comment><span lang=EN-US
style='font-family:Consolas;color:#006A00;'>topic&quot;</span></span><span
class=hljs-string><span lang=EN-US style='font-family:Consolas;color:#C41A16;
'>.</span></span></pre><pre style=';
;'><code><span lang=EN-US style='font-family:
Consolas;color:black;'>&nbsp;</span></code></pre><pre
style=';;'><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'> </span></span><span class=hljs-string><span lang=EN-US
style='font-family:Consolas;color:#C41A16;'>.</span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>/kafka</span></span><span class=hljs-literal><span
lang=EN-US style='font-family:Consolas;color:#AA0D91;'>-</span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>topics</span></span><span class=hljs-string><span lang=EN-US
style='font-family:Consolas;color:#C41A16;'>.</span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>sh</span></span><span class=line><span lang=EN-US
style='font-family:Consolas;color:black;'> </span></span><span
class=hljs-literal><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>--</span></span><span class=hljs-comment><span lang=EN-US
style='font-family:Consolas;color:#006A00;'>list</span></span><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'> </span></span><span class=hljs-literal><span lang=EN-US
style='font-family:Consolas;color:#AA0D91;'>--</span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>zookeeper</span></span><span class=line><span lang=EN-US
style='font-family:Consolas;color:black;'> </span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>10</span></span><span class=hljs-string><span lang=EN-US
style='font-family:Consolas;color:#C41A16;'>.</span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>104</span></span><span class=hljs-string><span lang=EN-US
style='font-family:Consolas;color:#C41A16;'>.</span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>23</span></span><span class=hljs-string><span lang=EN-US
style='font-family:Consolas;color:#C41A16;'>.</span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>206:2181</span></span></pre><pre style=';
;'><span class=hljs-comment><span
lang=EN-US style='font-family:Consolas;color:#006A00;'>my</span></span><span
class=hljs-literal><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>-</span></span><span class=hljs-comment><span lang=EN-US
style='font-family:Consolas;color:#006A00;'>replicated</span></span><span
class=hljs-literal><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>-</span></span><span class=hljs-comment><span lang=EN-US
style='font-family:Consolas;color:#006A00;'>topic</span></span></pre><pre
style=';;'><code><span
lang=EN-US style='font-family:Consolas;color:black;'>&nbsp;</span></code></pre><pre
style=';;'><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'> </span></span><span class=hljs-string><span lang=EN-US
style='font-family:Consolas;color:#C41A16;'>.</span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>/kafka</span></span><span class=hljs-literal><span
lang=EN-US style='font-family:Consolas;color:#AA0D91;'>-</span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>topics</span></span><span class=hljs-string><span lang=EN-US
style='font-family:Consolas;color:#C41A16;'>.</span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>sh</span></span><span class=line><span lang=EN-US
style='font-family:Consolas;color:black;'> </span></span><span
class=hljs-literal><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>--</span></span><span class=hljs-comment><span lang=EN-US
style='font-family:Consolas;color:#006A00;'>describe</span></span><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'> </span></span><span class=hljs-literal><span lang=EN-US
style='font-family:Consolas;color:#AA0D91;'>--</span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>zookeeper</span></span><span class=line><span lang=EN-US
style='font-family:Consolas;color:black;'> </span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>localhost:2181</span></span><span class=line><span
lang=EN-US style='font-family:Consolas;color:black;'> </span></span><span
class=hljs-literal><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>--</span></span><span class=hljs-comment><span lang=EN-US
style='font-family:Consolas;color:#006A00;'>topic</span></span><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'> </span></span><span class=hljs-comment><span lang=EN-US
style='font-family:Consolas;color:#006A00;'>my</span></span><span
class=hljs-literal><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>-</span></span><span class=hljs-comment><span lang=EN-US
style='font-family:Consolas;color:#006A00;'>replicated</span></span><span
class=hljs-literal><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>-</span></span><span class=hljs-comment><span lang=EN-US
style='font-family:Consolas;color:#006A00;'>topic</span></span></pre><pre
style=';;'><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>Topic:my</span></span><span class=hljs-literal><span
lang=EN-US style='font-family:Consolas;color:#AA0D91;'>-</span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>replicated</span></span><span class=hljs-literal><span
lang=EN-US style='font-family:Consolas;color:#AA0D91;'>-</span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>topic</span></span><span class=line><span lang=EN-US
style='font-family:Consolas;color:black;'>   </span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>PartitionCount:1</span></span><span class=line><span
lang=EN-US style='font-family:Consolas;color:black;'>    </span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>ReplicationFactor:3</span></span><span class=line><span
lang=EN-US style='font-family:Consolas;color:black;'> </span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>Configs:</span></span></pre><pre style=';
;'><span class=line><span lang=EN-US
style='font-family:Consolas;color:black;'>    </span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>Topic:</span></span><span class=line><span lang=EN-US
style='font-family:Consolas;color:black;'> </span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>my</span></span><span class=hljs-literal><span lang=EN-US
style='font-family:Consolas;color:#AA0D91;'>-</span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>replicated</span></span><span class=hljs-literal><span
lang=EN-US style='font-family:Consolas;color:#AA0D91;'>-</span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>topic</span></span><span class=line><span lang=EN-US
style='font-family:Consolas;color:black;'>  </span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>Partition:</span></span><span class=line><span lang=EN-US
style='font-family:Consolas;color:black;'> </span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>0</span></span><span class=line><span lang=EN-US
style='font-family:Consolas;color:black;'>    </span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>Leader:</span></span><span class=line><span lang=EN-US
style='font-family:Consolas;color:black;'> </span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>4</span></span><span class=line><span lang=EN-US
style='font-family:Consolas;color:black;'>   </span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>Replicas:</span></span><span class=line><span lang=EN-US
style='font-family:Consolas;color:black;'> </span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>4</span></span><span class=hljs-string><span lang=EN-US
style='font-family:Consolas;color:#C41A16;'>,</span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>2</span></span><span class=hljs-string><span lang=EN-US
style='font-family:Consolas;color:#C41A16;'>,</span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>3</span></span><span class=line><span lang=EN-US
style='font-family:Consolas;color:black;'> </span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>Isr:</span></span><span class=line><span lang=EN-US
style='font-family:Consolas;color:black;'> </span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>4</span></span><span class=hljs-string><span lang=EN-US
style='font-family:Consolas;color:#C41A16;'>,</span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>2</span></span><span class=hljs-string><span lang=EN-US
style='font-family:Consolas;color:#C41A16;'>,</span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>3</span></span></pre><pre style=';
;'><code><span lang=EN-US style='font-family:
Consolas;color:black;'>&nbsp;</span></code></pre><pre
style=';;'><code><span
lang=EN-US style='font-family:Consolas;color:black;'>&nbsp;</span></code></pre><pre
style=';;'><code><span
lang=EN-US style='font-family:Consolas;color:black;'>&nbsp;</span></code></pre><pre
style=';;'><span
class=hljs-comment><span style='color:#006A00;'>我们可以通过</span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>Kafka</span></span><span class=hljs-comment><span
style='color:#006A00;'>自带的</span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>bin/kafka</span></span><span class=hljs-literal><span
lang=EN-US style='font-family:Consolas;color:#AA0D91;'>-</span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>console</span></span><span class=hljs-literal><span
lang=EN-US style='font-family:Consolas;color:#AA0D91;'>-</span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>producer</span></span><span class=hljs-string><span
lang=EN-US style='font-family:Consolas;color:#C41A16;'>.</span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>sh</span></span><span class=hljs-comment><span
style='color:#006A00;'>和</span></span><span class=hljs-comment><span
lang=EN-US style='font-family:Consolas;color:#006A00;'>bin/kafka</span></span><span
class=hljs-literal><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>-</span></span><span class=hljs-comment><span lang=EN-US
style='font-family:Consolas;color:#006A00;'>console</span></span><span
class=hljs-literal><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>-</span></span><span class=hljs-comment><span lang=EN-US
style='font-family:Consolas;color:#006A00;'>consumer</span></span><span
class=hljs-string><span lang=EN-US style='font-family:Consolas;color:#C41A16;
'>.</span></span><span class=hljs-comment><span lang=EN-US
style='font-family:Consolas;color:#006A00;'>sh</span></span><span
class=hljs-comment><span style='color:#006A00;'>脚本，来验证演示如果发布消息、消费消息。</span></span><span
class=line><span style='font-family:Consolas;color:black;'> </span></span><span
class=hljs-comment><span style='color:#006A00;'>在一个终端，启动</span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>Producer</span></span><span class=hljs-comment><span
style='color:#006A00;'>，并向我们上面创建的名称为</span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>my</span></span><span class=hljs-literal><span lang=EN-US
style='font-family:Consolas;color:#AA0D91;'>-</span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>replicated</span></span><span class=hljs-literal><span
lang=EN-US style='font-family:Consolas;color:#AA0D91;'>-</span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>topic5</span></span><span class=hljs-comment><span
style='color:#006A00;'>的</span></span><span class=hljs-comment><span
lang=EN-US style='font-family:Consolas;color:#006A00;'>Topic</span></span><span
class=hljs-comment><span style='color:#006A00;'>中生产消息，执行如下脚本：</span></span></pre><pre
style=';;'><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>bin/kafka</span></span><span class=hljs-literal><span
lang=EN-US style='font-family:Consolas;color:#AA0D91;'>-</span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>console</span></span><span class=hljs-literal><span
lang=EN-US style='font-family:Consolas;color:#AA0D91;'>-</span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>producer</span></span><span class=hljs-string><span
lang=EN-US style='font-family:Consolas;color:#C41A16;'>.</span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>sh</span></span><span class=line><span lang=EN-US
style='font-family:Consolas;color:black;'> </span></span><span
class=hljs-literal><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>--</span></span><span class=hljs-comment><span lang=EN-US
style='font-family:Consolas;color:#006A00;'>broker</span></span><span
class=hljs-literal><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>-</span></span><span class=hljs-comment><span lang=EN-US
style='font-family:Consolas;color:#006A00;'>list</span></span><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'> </span></span><span class=hljs-comment><span lang=EN-US
style='font-family:Consolas;color:#006A00;'>h1:9092</span></span><span
class=hljs-string><span lang=EN-US style='font-family:Consolas;color:#C41A16;
'>,</span></span><span class=hljs-comment><span lang=EN-US
style='font-family:Consolas;color:#006A00;'>h2:9092</span></span><span
class=hljs-string><span lang=EN-US style='font-family:Consolas;color:#C41A16;
'>,</span></span><span class=hljs-comment><span lang=EN-US
style='font-family:Consolas;color:#006A00;'>h3:9092</span></span><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'> </span></span><span class=hljs-literal><span lang=EN-US
style='font-family:Consolas;color:#AA0D91;'>--</span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>topic</span></span><span class=line><span lang=EN-US
style='font-family:Consolas;color:black;'> </span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>my</span></span><span class=hljs-literal><span lang=EN-US
style='font-family:Consolas;color:#AA0D91;'>-</span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>replicated</span></span><span class=hljs-literal><span
lang=EN-US style='font-family:Consolas;color:#AA0D91;'>-</span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>topic5</span></span></pre><pre style=';
;'><span class=hljs-comment><span
lang=EN-US style='font-family:Consolas;color:#006A00;'>bin/kafka</span></span><span
class=hljs-literal><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>-</span></span><span class=hljs-comment><span lang=EN-US
style='font-family:Consolas;color:#006A00;'>console</span></span><span
class=hljs-literal><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>-</span></span><span class=hljs-comment><span lang=EN-US
style='font-family:Consolas;color:#006A00;'>producer</span></span><span
class=hljs-string><span lang=EN-US style='font-family:Consolas;color:#C41A16;
'>.</span></span><span class=hljs-comment><span lang=EN-US
style='font-family:Consolas;color:#006A00;'>sh</span></span><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'> </span></span><span class=hljs-literal><span lang=EN-US
style='font-family:Consolas;color:#AA0D91;'>--</span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>broker</span></span><span class=hljs-literal><span
lang=EN-US style='font-family:Consolas;color:#AA0D91;'>-</span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>list</span></span><span class=line><span lang=EN-US
style='font-family:Consolas;color:black;'> </span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>localhost:9092</span></span><span class=line><span
lang=EN-US style='font-family:Consolas;color:black;'> </span></span><span
class=hljs-literal><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>--</span></span><span class=hljs-comment><span lang=EN-US
style='font-family:Consolas;color:#006A00;'>topic</span></span><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'> </span></span><span class=hljs-comment><span lang=EN-US
style='font-family:Consolas;color:#006A00;'>im</span></span><span
class=hljs-literal><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>-</span></span><span class=hljs-comment><span lang=EN-US
style='font-family:Consolas;color:#006A00;'>msg</span></span></pre><pre
style=';;'><code><span
lang=EN-US style='font-family:Consolas;color:black;'>&nbsp;</span></code></pre><pre
style=';;'><span
class=hljs-comment><span style='color:#006A00;'>在另一个终端，启动</span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>Consumer</span></span><span class=hljs-comment><span
style='color:#006A00;'>，并订阅我们上面创建的名称为</span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>my</span></span><span class=hljs-literal><span lang=EN-US
style='font-family:Consolas;color:#AA0D91;'>-</span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>replicated</span></span><span class=hljs-literal><span
lang=EN-US style='font-family:Consolas;color:#AA0D91;'>-</span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>topic5</span></span><span class=hljs-comment><span
style='color:#006A00;'>的</span></span><span class=hljs-comment><span
lang=EN-US style='font-family:Consolas;color:#006A00;'>Topic</span></span><span
class=hljs-comment><span style='color:#006A00;'>中生产的消息，执行如下脚本：</span></span></pre><pre
style=';;'><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>bin/kafka</span></span><span class=hljs-literal><span
lang=EN-US style='font-family:Consolas;color:#AA0D91;'>-</span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>console</span></span><span class=hljs-literal><span
lang=EN-US style='font-family:Consolas;color:#AA0D91;'>-</span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>consumer</span></span><span class=hljs-string><span
lang=EN-US style='font-family:Consolas;color:#C41A16;'>.</span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>sh</span></span><span class=line><span lang=EN-US
style='font-family:Consolas;color:black;'> </span></span><span
class=hljs-literal><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>--</span></span><span class=hljs-comment><span lang=EN-US
style='font-family:Consolas;color:#006A00;'>zookeeper</span></span><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'> </span></span><span class=hljs-comment><span lang=EN-US
style='font-family:Consolas;color:#006A00;'>h1:2181</span></span><span
class=hljs-string><span lang=EN-US style='font-family:Consolas;color:#C41A16;
'>,</span></span><span class=hljs-comment><span lang=EN-US
style='font-family:Consolas;color:#006A00;'>h2:2181</span></span><span
class=hljs-string><span lang=EN-US style='font-family:Consolas;color:#C41A16;
'>,</span></span><span class=hljs-comment><span lang=EN-US
style='font-family:Consolas;color:#006A00;'>h3:2181</span></span><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'> </span></span><span class=hljs-literal><span lang=EN-US
style='font-family:Consolas;color:#AA0D91;'>--</span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>from</span></span><span class=hljs-literal><span lang=EN-US
style='font-family:Consolas;color:#AA0D91;'>-</span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>beginning</span></span><span class=line><span lang=EN-US
style='font-family:Consolas;color:black;'> </span></span><span
class=hljs-literal><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>--</span></span><span class=hljs-comment><span lang=EN-US
style='font-family:Consolas;color:#006A00;'>topic</span></span><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'> </span></span><span class=hljs-comment><span lang=EN-US
style='font-family:Consolas;color:#006A00;'>my</span></span><span
class=hljs-literal><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>-</span></span><span class=hljs-comment><span lang=EN-US
style='font-family:Consolas;color:#006A00;'>replicated</span></span><span
class=hljs-literal><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>-</span></span><span class=hljs-comment><span lang=EN-US
style='font-family:Consolas;color:#006A00;'>topic5</span></span></pre><pre
style=';;'><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>bin/kafka</span></span><span class=hljs-literal><span
lang=EN-US style='font-family:Consolas;color:#AA0D91;'>-</span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>console</span></span><span class=hljs-literal><span
lang=EN-US style='font-family:Consolas;color:#AA0D91;'>-</span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>consumer</span></span><span class=hljs-string><span
lang=EN-US style='font-family:Consolas;color:#C41A16;'>.</span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>sh</span></span><span class=line><span lang=EN-US
style='font-family:Consolas;color:black;'> </span></span><span
class=hljs-literal><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>--</span></span><span class=hljs-comment><span lang=EN-US
style='font-family:Consolas;color:#006A00;'>zookeeper</span></span><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'> </span></span><span class=hljs-comment><span lang=EN-US
style='font-family:Consolas;color:#006A00;'>localhost:2181</span></span><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'> </span></span><span class=hljs-literal><span lang=EN-US
style='font-family:Consolas;color:#AA0D91;'>--</span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>from</span></span><span class=hljs-literal><span lang=EN-US
style='font-family:Consolas;color:#AA0D91;'>-</span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>beginning</span></span><span class=line><span lang=EN-US
style='font-family:Consolas;color:black;'> </span></span><span
class=hljs-literal><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>--</span></span><span class=hljs-comment><span lang=EN-US
style='font-family:Consolas;color:#006A00;'>topic</span></span><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'> </span></span><span class=hljs-comment><span lang=EN-US
style='font-family:Consolas;color:#006A00;'>im</span></span><span
class=hljs-literal><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>-</span></span><span class=hljs-comment><span lang=EN-US
style='font-family:Consolas;color:#006A00;'>msg</span></span></pre><pre
style=';;'><code><span
lang=EN-US style='font-family:Consolas;color:black;'>&nbsp;</span></code></pre><pre
style=';;'><span
class=hljs-comment><span style='color:#006A00;'>如果收到消息，表示</span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>kafka</span></span><span class=hljs-comment><span
style='color:#006A00;'>集群运行正常</span></span></pre>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<h2><a name="_Toc416884143"><span lang=EN-US>Storm</span></a><span
style='font-family:黑体'>子系统简介</span></h2>

<h3><a name="_Toc416884144"><span lang=EN-US>Storm</span></a><span
style='font-family:宋体'>组件说明</span></h3>

<ul style='margin-top:0cm' type=disc>
 <li class=MsoNormal style='color:#333333;layout-grid-mode:both;'><span lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>storm</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>包含两种节点：</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>master</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>和</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>worker</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>；</span></li>
 <li class=MsoNormal style='color:#333333;layout-grid-mode:both;'><span lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>master</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>上运行</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>Nimbus</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>，负责：</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>distribute
     code</span><span style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>、</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>assign
     task</span><span style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>、</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>monitor
     failutes</span><span style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>；</span></li>
 <li class=MsoNormal style='color:#333333;layout-grid-mode:both;'><span lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>worker</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>上运行</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>Supervisor</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>，负责：监听</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>Nimbus</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>分配的任务，并启停</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>worker
     precess</span><span style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>；</span></li>
 <li class=MsoNormal style='color:#333333;layout-grid-mode:both;'><span lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>zookeeper</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>负责协调</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>Nimbus</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>和</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>Supervisor</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>之间的关系，所有状态信息都存储在</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>zookeeper
     or local host</span><span style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>；因此，重启</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>Nimbus
     or Supervisor</span><span style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>进程，对用户来说无影响；</span></li>
</ul>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:6.75pt;margin-left:
0cm;;'><span lang=EN-US style='font-size:
10.5pt;font-family:"Helvetica","sans-serif";color:#333333'><img width=320
height=259 id="图片 8" src="2015-03-15-ELK日志分析系统.files/image004.gif" alt=storm></span></p>

<h5 style='margin-top:0cm;margin-right:0cm;margin-bottom:6.75pt;margin-left:
0cm;'><span style='font-family:"微软雅黑","sans-serif";color:#333333;
font-weight:normal'>关于</span><span lang=EN-US style='font-family:"Helvetica","sans-serif";
color:#333333;font-weight:normal'> spout </span><span style='font-family:"微软雅黑","sans-serif";
color:#333333;font-weight:normal'>和</span><span lang=EN-US style='font-family:
"Helvetica","sans-serif";color:#333333;font-weight:normal'> bolt </span><span
style='font-family:"微软雅黑","sans-serif";color:#333333;font-weight:normal'>，说几点：</span></h5>

<ul style='margin-top:0cm' type=disc>
 <li class=MsoNormal style='color:#333333;layout-grid-mode:both;'><span lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>spout</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>（龙卷风、气旋）：</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>
     source of stream</span><span style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>，向</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>topology</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>中拉入数据的原点；</span></li>
 <li class=MsoNormal style='color:#333333;layout-grid-mode:both;'><span lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>bolt</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>（闪电）：处理</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>
     stream</span><span style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>，通过</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>run
     functions</span><span style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>、</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>filter
     tuples</span><span style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>、</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>do
     streaming aggregations</span><span style='font-size:10.5pt;font-family:
     "微软雅黑","sans-serif"'>、</span><span lang=EN-US style='font-size:10.5pt;
     font-family:"Helvetica","sans-serif"'>do streaming join</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>、</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>talk
     to database… </span><span style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>来做任何事情；</span></li>
 <li class=MsoNormal style='color:#333333;layout-grid-mode:both;'><span lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>topology</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>：由</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>spout</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>、</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>bolt</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>以及他们之间的关系构成，是</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>client</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>提交给</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>Storm
     cluster</span><span style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>执行的基本单元；</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>
     topology</span><span style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>中所有</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>node</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>都是并发运行的，可以配置每个</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>node</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>的并发数；</span></li>
</ul>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:6.75pt;margin-left:
0cm;;'><span lang=EN-US style='font-size:
10.5pt;font-family:"Helvetica","sans-serif";color:#333333'><img width=361
height=278 id="图片 9" src="2015-03-15-ELK日志分析系统.files/image005.jpg"
alt="spout_bolt"></span></p>

<ul style='margin-top:0cm' type=disc>
 <li class=MsoNormal style='color:#333333;layout-grid-mode:both;'><span lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>notes(ningg)</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>：</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>topology</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>中</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>node</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>是什么概念？</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>spout</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>、</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>bolt</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>？</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>master</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>、</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>worker</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>？</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>jvm
     process</span><span style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>？</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>thread</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>？</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>
     RE</span><span style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>：</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>master</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>、</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>worker</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>对应</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>Storm</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>的</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>node</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>，</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>master</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>负责控制，</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>worker</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>负责具体执行；</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>spout</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>、</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>bolt</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>是逻辑上的，并且分布在不同的</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>worker</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>上；每个</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>spout</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>、</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>bolt</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>可配置并发数，这个并发数对应启动的</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>thread</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>；不同的</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>spout</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>、</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>bolt</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>对应不同的</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>thread</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>，</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>thread</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>间不能共用；这些所有的</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>thread</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>由所有的</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>worker
     process</span><span style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>来执行，举例，累计</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>300</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>个</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>thread</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>，启动了</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>30</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>个</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>worker</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>，则平均每个</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>worker
     process</span><span style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>对应执行</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>10</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>个</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>thread</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>（前面的说法对吗？哈哈）</span></li>
</ul>

<h5 style='margin-top:0cm;margin-right:0cm;margin-bottom:6.75pt;margin-left:
0cm;'><span style='font-family:"微软雅黑","sans-serif";color:#333333;
font-weight:normal'>关于数据模型，即数据的结构，说几点：</span></h5>

<ul style='margin-top:0cm' type=disc>
 <li class=MsoNormal style='color:#333333;layout-grid-mode:both;'><span lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>Storm</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>中，使用</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>tuple</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>结构来存储数据，</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>tuple</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>由</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>fields</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>构成，</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>field</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>可以为任意类型；</span></li>
 <li class=MsoNormal style='color:#333333;layout-grid-mode:both;'><span lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>topology</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>中</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>spout</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>、</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>bolt</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>必须声明其</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>emit</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>的</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>tuple</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>格式：</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>declareOutputFields()</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>；</span></li>
 <li class=MsoNormal style='color:#333333;layout-grid-mode:both;'><span lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>setSpout/setBolt</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>用于定义</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>spout</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>和</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>bolt</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>，输入参数：</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>node
     id</span><span style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>、</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>processing
     logic</span><span style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>、</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>amount
     of parallelism</span><span style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>；</span></li>
 <li class=MsoNormal style='color:#333333;layout-grid-mode:both;'><span lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>processing
     logic</span><span style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>对应类</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>spout/bolt</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>，需要</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>implement
     IRichSpout/IRichBolt</span><span style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>；</span></li>
</ul>

<h5 style='margin-top:0cm;margin-right:0cm;margin-bottom:6.75pt;margin-left:
0cm;'><span lang=EN-US style='font-family:"Helvetica","sans-serif";
color:#333333;font-weight:normal'>Storm</span><span style='font-family:"微软雅黑","sans-serif";
color:#333333;font-weight:normal'>有两种执行模式，</span><span lang=EN-US
style='font-family:"Helvetica","sans-serif";color:#333333;font-weight:normal'>local
mode</span><span style='font-family:"微软雅黑","sans-serif";color:#333333;
font-weight:normal'>和</span><span lang=EN-US style='font-family:"Helvetica","sans-serif";
color:#333333;font-weight:normal'>distributed mode</span><span
style='font-family:"微软雅黑","sans-serif";color:#333333;font-weight:normal'>，补充几点：</span></h5>

<ul style='margin-top:0cm' type=disc>
 <li class=MsoNormal style='color:#333333;layout-grid-mode:both;'><span lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>local
     mode</span><span style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>，在本地的</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>process</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>中通过</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>thread</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>模拟</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>worker</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>，多用于</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>testing</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>和</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>development
     topology</span><span style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>；</span></li>
 <li class=MsoNormal style='color:#333333;layout-grid-mode:both;'><span lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>distributed
     mode</span><span style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>，用户向</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>master</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>提交</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>topology</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>以及运行</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>topology</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>所需的所有</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>code</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>；</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>master</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>向</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>worker</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>分发</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>topolog</span></li>
</ul>

<h5 style='margin-top:0cm;margin-right:0cm;margin-bottom:6.75pt;margin-left:
0cm;'><span style='font-family:"微软雅黑","sans-serif";color:#333333;
font-weight:normal'>关于</span><span lang=EN-US style='font-family:"Helvetica","sans-serif";
color:#333333;font-weight:normal'>Stream groupings</span><span
style='font-family:"微软雅黑","sans-serif";color:#333333;font-weight:normal'>，几点：</span></h5>

<ul style='margin-top:0cm' type=disc>
 <li class=MsoNormal style='color:#333333;layout-grid-mode:both;'><span lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>stream
     grouping</span><span style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>解决的问题：多个执行</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>spout</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>逻辑的</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>thread</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>都输出</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>tuple</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>，这些</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>tuple</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>要发送给</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>bolt</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>对应的多个</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>thread</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>，问题来了，</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>tuple</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>发给</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>bolt</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>的哪个</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>thread</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>？即，</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>stream
     grouping</span><span style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>解决：</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>tuple</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>在不同</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>task</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>之间传递关系；</span></li>
 <li class=MsoNormal style='color:#333333;layout-grid-mode:both;'><span lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>shuffle
     grouping</span><span style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>，随机分发；</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>field
     grouping</span><span style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>，根据给定的</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>field</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>进行分发；</span></li>
</ul>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:6.75pt;margin-left:
0cm;;'><span lang=EN-US style='font-size:
10.5pt;font-family:"Helvetica","sans-serif";color:#333333'><img width=320
height=239 id="图片 10" src="2015-03-15-ELK日志分析系统.files/image006.gif"
alt=grouping></span></p>

<h3><a name="_Toc416884145"><span style='font-family:宋体'>安装</span><span
lang=EN-US>storm</span></a></h3>

<pre style=';;'><span
class=haml><span lang=EN-US style='font-family:Consolas;color:black;'>1</span></span><span class=haml><span style='color:black;'>、前期准备：</span></span></pre><pre style=';;'><span class=haml><span lang=EN-US style='font-family:
Consolas;color:black;'>     -</span></span><span class=ruby><span
lang=EN-US style='font-family:Consolas;color:black;'> </span></span><span
class=hljs-string><span lang=EN-US style='font-family:Consolas;color:#C41A16;
'>&quot;10.104.23.206&quot;</span></span><span class=ruby><span
lang=EN-US style='font-family:Consolas;color:black;'> </span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>#t-storm2    </span></span></pre><pre style='line-height:
16.8pt;;'><span class=haml><span
lang=EN-US style='font-family:Consolas;color:black;'>     -</span></span><span
class=ruby><span lang=EN-US style='font-family:Consolas;color:black;'> </span></span><span class=hljs-string><span lang=EN-US
style='font-family:Consolas;color:#C41A16;'>&quot;10.104.23.207&quot;</span></span><span
class=ruby><span lang=EN-US style='font-family:Consolas;color:black;'> </span></span><span class=hljs-comment><span lang=EN-US
style='font-family:Consolas;color:#006A00;'>#t-storm3</span></span></pre><pre
style=';;'><span
class=haml><span lang=EN-US style='font-family:Consolas;color:black;'>     -</span></span><span class=ruby><span lang=EN-US style='font-family:
Consolas;color:black;'> </span></span><span class=hljs-string><span
lang=EN-US style='font-family:Consolas;color:#C41A16;'>&quot;10.251.169.57&quot;</span></span><span
class=ruby><span lang=EN-US style='font-family:Consolas;color:black;'> </span></span><span class=hljs-comment><span lang=EN-US
style='font-family:Consolas;color:#006A00;'>#t-storm4</span></span></pre><pre
style=';;'><span
class=haml><span style='color:black;'>共</span></span><span
class=haml><span lang=EN-US style='font-family:Consolas;color:black;'>3</span></span><span class=haml><span style='color:black;'>台，每台上面均有</span></span><span class=haml><span lang=EN-US
style='font-family:Consolas;color:black;'>storm,zookeeper</span></span><span
class=haml><span style='color:black;'>，以</span></span><span
class=haml><span lang=EN-US style='font-family:Consolas;color:black;'>t-storm2</span></span><span class=haml><span style='color:black;
'>为主节点</span></span></pre><pre style=';
;'><span class=haml><span lang=EN-US
style='font-family:Consolas;color:black;'>&nbsp;</span></span></pre><pre
style=';;'><span
class=haml0><span lang=EN-US style='font-family:Consolas;color:black;'>java</span></span><span class=haml><span style='color:black;'>环境</span></span></pre><pre style=';;
'><span class=haml><span lang=EN-US style='font-family:
Consolas;color:black;'>yum install java-1.7.0-openjdk-devel</span></span></pre><pre
style=';;'><span
class=haml><span lang=EN-US style='font-family:Consolas;color:black;'>&nbsp;</span></span></pre><pre style=';;'><span class=haml><span lang=EN-US style='font-family:
Consolas;color:black;'>2</span></span><span class=haml><span
style='color:black;'>、下载</span></span><span class=haml><span
lang=EN-US style='font-family:Consolas;color:black;'>storm</span></span><span
class=haml><span style='color:black;'>包</span></span></pre><pre
style=';;'><span
class=haml><span lang=EN-US style='font-family:Consolas;color:black;'>wget http://mirror.bit.edu.cn/apache/incubator/storm/apache-storm-0.9.2-incubating/apache-storm-0.9.2-incubating.tar.gz</span></span></pre><pre
style=';;'><span
class=haml><span lang=EN-US style='font-family:Consolas;color:black;'>&nbsp;</span></span></pre><pre style=';;'><span class=haml><span style='color:black;
'>解压、进入</span></span><span class=haml><span lang=EN-US
style='font-family:Consolas;color:black;'>conf</span></span><span
class=haml><span style='color:black;'>目录</span></span></pre><pre
style=';;'><span
class=haml><span style='color:black;'>配置</span></span><span
class=haml><span lang=EN-US style='font-family:Consolas;color:black;'>storm.yaml</span></span><span class=haml><span style='color:black;
'>：（</span></span><span class=haml><span lang=EN-US
style='font-family:Consolas;color:black;'>zookeeper</span></span><span
class=haml><span style='color:black;'>安装参见</span></span><span
class=haml><span lang=EN-US style='font-family:Consolas;color:black;'>kafka</span></span><span class=haml><span style='color:black;'>）</span></span></pre><pre style=';;
'><span class=haml><span lang=EN-US style='font-family:
Consolas;color:black;'> storm.zookeeper.servers:</span></span></pre><pre
style=';;'><span
class=haml><span lang=EN-US style='font-family:Consolas;color:black;'>     -</span></span><span class=ruby><span lang=EN-US style='font-family:
Consolas;color:black;'> </span></span><span class=hljs-string><span
lang=EN-US style='font-family:Consolas;color:#C41A16;'>&quot;10.104.23.206&quot;</span></span><span
class=ruby><span lang=EN-US style='font-family:Consolas;color:black;'> </span></span><span class=hljs-comment><span lang=EN-US
style='font-family:Consolas;color:#006A00;'>#t-storm2</span></span></pre><pre
style=';;'><span
class=haml><span lang=EN-US style='font-family:Consolas;color:black;'>     -</span></span><span class=ruby><span lang=EN-US style='font-family:
Consolas;color:black;'> </span></span><span class=hljs-string><span
lang=EN-US style='font-family:Consolas;color:#C41A16;'>&quot;10.104.23.207&quot;</span></span><span
class=ruby><span lang=EN-US style='font-family:Consolas;color:black;'> </span></span><span class=hljs-comment><span lang=EN-US
style='font-family:Consolas;color:#006A00;'>#t-storm3</span></span></pre><pre
style=';;'><span
class=haml><span lang=EN-US style='font-family:Consolas;color:black;'>     -</span></span><span class=ruby><span lang=EN-US style='font-family:
Consolas;color:black;'> </span></span><span class=hljs-string><span
lang=EN-US style='font-family:Consolas;color:#C41A16;'>&quot;10.251.169.57&quot;</span></span><span
class=ruby><span lang=EN-US style='font-family:Consolas;color:black;'> </span></span><span class=hljs-comment><span lang=EN-US
style='font-family:Consolas;color:#006A00;'>#t-storm4</span></span></pre><pre
style=';;'><span
class=haml><span lang=EN-US style='font-family:Consolas;color:black;'>#</span></span></pre><pre style=';;
'><span class=haml><span lang=EN-US style='font-family:
Consolas;color:black;'> nimbus.host: &quot;10.104.23.206&quot;</span></span></pre><pre
style=';;'><span
class=haml><span lang=EN-US style='font-family:Consolas;color:black;'>&nbsp;</span></span></pre><pre style=';;'><span class=haml><span style='color:black;
'>在</span></span><span class=haml><span lang=EN-US
style='font-family:Consolas;color:black;'>master</span></span><span
class=haml><span style='color:black;'>节点启动：</span></span></pre><pre
style=';;'><span
class=haml><span lang=EN-US style='font-family:Consolas;color:black;'>nohup storm nimbus &amp;</span></span></pre><pre style='line-height:
16.8pt;;'><span class=haml><span
lang=EN-US style='font-family:Consolas;color:black;'>nohup storm ui &amp;</span></span></pre><pre
style=';;'><span
class=haml><span lang=EN-US style='font-family:Consolas;color:black;'>nohup storm supervisor &amp;</span></span></pre><pre style='line-height:
16.8pt;;'><span class=haml><span
lang=EN-US style='font-family:Consolas;color:black;'>&nbsp;</span></span></pre><pre
style=';;'><span
class=haml><span style='color:black;'>在其他</span></span><span
class=haml><span lang=EN-US style='font-family:Consolas;color:black;'>nodes</span></span><span class=haml><span style='color:black;'>节点只需启动</span></span><span class=haml><span lang=EN-US style='font-family:
Consolas;color:black;'>supervisor </span></span></pre><pre
style=';;'><span
class=haml><span lang=EN-US style='font-family:Consolas;color:black;'>&nbsp;</span></span></pre><pre style=';;'><span class=haml><span lang=EN-US style='font-family:
Consolas;color:black;'>&nbsp;</span></span></pre>

<h6 style='margin-top:0cm;margin-right:0cm;margin-bottom:6.75pt;margin-left:
0cm;'><span style='font-size:9.0pt;line-height:133%;font-family:
宋体;color:#888888;text-transform:uppercase;font-weight:normal'>打开</span><span
lang=EN-US style='font-size:9.0pt;line-height:133%;font-family:"Helvetica","sans-serif";
color:#888888;text-transform:uppercase;font-weight:normal'>WEB</span><span
style='font-size:9.0pt;line-height:133%;font-family:宋体;color:#888888;
text-transform:uppercase;font-weight:normal'>界面</span></h6>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:6.75pt;margin-left:
0cm;;'><span style='font-size:10.5pt;
color:#333333'>可看到有</span><span lang=EN-US style='font-size:10.5pt;font-family:
"Helvetica","sans-serif";color:#333333'>3</span><span style='font-size:10.5pt;
color:#333333'>个</span><span lang=EN-US style='font-size:10.5pt;font-family:
"Helvetica","sans-serif";color:#333333'>supervisor</span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:6.75pt;margin-left:
0cm;;'><span lang=EN-US style='font-size:
10.5pt;font-family:"Helvetica","sans-serif";color:#333333'><img width=709
height=111 id="图片 11" src="2015-03-15-ELK日志分析系统.files/image007.jpg"
alt="storm_ui"></span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<h2><a name="_Toc416884146"><span lang=EN-US>Elasticsearch</span></a><span
style='font-family:黑体'>子系统简介</span></h2>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:6.75pt;margin-left:
0cm;;'><span lang=EN-US style='font-size:
10.5pt;font-family:"Helvetica","sans-serif";color:#333333'>Elasticsearch </span><span
style='font-size:10.5pt;color:#333333'>是一个建立在全文搜索引擎</span><span lang=EN-US
style='font-size:10.5pt;font-family:"Helvetica","sans-serif";color:#333333'>
Apache Lucene(TM) </span><span style='font-size:10.5pt;color:#333333'>基础上的搜索引擎，可以说</span><span
lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif";
color:#333333'> Lucene </span><span style='font-size:10.5pt;color:#333333'>是当今最先进，最高效的全功能开源搜索引擎框架。</span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:6.75pt;margin-left:
0cm;;'><span style='font-size:10.5pt;
color:#333333'>但是</span><span lang=EN-US style='font-size:10.5pt;font-family:
"Helvetica","sans-serif";color:#333333'> Lucene </span><span style='font-size:
10.5pt;color:#333333'>只是一个框架，要充分利用它的功能，你需要使用</span><span lang=EN-US
style='font-size:10.5pt;font-family:"Helvetica","sans-serif";color:#333333'>
JAVA</span><span style='font-size:10.5pt;color:#333333'>，并且在你的程序中集成</span><span
lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif";
color:#333333'> Lucene</span><span style='font-size:10.5pt;color:#333333'>。更糟的是，你需要做很多的学习了解，才能明白它是如何运行的，</span><span
lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif";
color:#333333'>Lucene </span><span style='font-size:10.5pt;color:#333333'>确实非常复杂。</span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:6.75pt;margin-left:
0cm;;'><span lang=EN-US style='font-size:
10.5pt;font-family:"Helvetica","sans-serif";color:#333333'>Elasticsearch </span><span
style='font-size:10.5pt;color:#333333'>使用</span><span lang=EN-US
style='font-size:10.5pt;font-family:"Helvetica","sans-serif";color:#333333'>
Lucene </span><span style='font-size:10.5pt;color:#333333'>作为内部引擎，但是在你使用它做全文搜索时，只需要使用统一开发好的</span><span
lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif";
color:#333333'>API</span><span style='font-size:10.5pt;color:#333333'>即可，而并不需要了解其背后复杂的</span><span
lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif";
color:#333333'> Lucene </span><span style='font-size:10.5pt;color:#333333'>的运行原理。</span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:6.75pt;margin-left:
0cm;;'><span style='font-size:10.5pt;
color:#333333'>当然</span><span lang=EN-US style='font-size:10.5pt;font-family:
"Helvetica","sans-serif";color:#333333'> Elasticsearch </span><span
style='font-size:10.5pt;color:#333333'>并不仅仅是</span><span lang=EN-US
style='font-size:10.5pt;font-family:"Helvetica","sans-serif";color:#333333'>
Lucene </span><span style='font-size:10.5pt;color:#333333'>那么简单，它不仅包括了全文搜索功能，还可以进行以下工作</span><span
lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif";
color:#333333'>:</span></p>

<ul style='margin-top:0cm' type=disc>
 <li class=MsoNormal style='color:#333333;layout-grid-mode:both;'><span style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>分布式实时文件存储，并将每一个字段都编入索引，使其可以被搜索。</span></li>
 <li class=MsoNormal style='color:#333333;layout-grid-mode:both;'><span style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>实时分析的分布式搜索引擎。</span></li>
 <li class=MsoNormal style='color:#333333;layout-grid-mode:both;'><span style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>可以扩展到上百台服务器，处理</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>PB</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>级别的结构化或非结构化数据。</span></li>
 <li class=MsoNormal style='color:#333333;layout-grid-mode:both;'><span style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>这么多的功能被集成到一台服务器上，你可以轻松地通过客户端或者任何你喜欢的程序语言与</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>
     ES </span><span style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>的</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>
     RESTful API </span><span style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>进行交流。</span></li>
</ul>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:6.75pt;margin-left:
0cm;;'><span lang=EN-US style='font-size:
10.5pt;font-family:"Helvetica","sans-serif";color:#333333'>Elasticsearch </span><span
style='font-size:10.5pt;color:#333333'>的上手是非常简单的。它附带了很多非常合理的默认值，这让初学者很好地避免一上手就要面对复杂的理论，它安装好了就可以使用了，用很小的学习成本就可以变得很有生产力。</span></p>

<h3><a name="_Toc416884147"><span lang=EN-US>Elasticsearch </span></a><span
style='font-family:宋体'>的分布式</span></h3>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:6.75pt;margin-left:
0cm;;'><span style='font-size:10.5pt;
color:#333333'>你甚至不需要关于分布式系统的任何内容，比如分片、集群、发现等成堆的分布式概念。你可能在你的笔记本中运行着刚才的教程，如果你想在一个拥有</span><span
lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif";
color:#333333'>100</span><span style='font-size:10.5pt;color:#333333'>个节点的集群中运行教程，你会发现操作是完全一样的。</span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:6.75pt;margin-left:
0cm;;'><span lang=EN-US style='font-size:
10.5pt;font-family:"Helvetica","sans-serif";color:#333333'>Elasticsearch </span><span
style='font-size:10.5pt;color:#333333'>很努力地在避免复杂的分布式系统，很多操作都是自动完成的：</span></p>

<ul style='margin-top:0cm' type=disc>
 <li class=MsoNormal style='color:#333333;layout-grid-mode:both;'><span style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>可以将你的文档分区到不同容器或者</span><span
     style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'> </span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>分片</span><span
     style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'> </span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>中，这些文档可能被存在一个节点或者多个节点。</span></li>
 <li class=MsoNormal style='color:#333333;layout-grid-mode:both;'><span style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>跨节点平衡集群中节点间的索引与搜索负载。</span></li>
 <li class=MsoNormal style='color:#333333;layout-grid-mode:both;'><span style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>自动复制你的数据以提供冗余副本，防止硬件错误导致数据丢失。</span></li>
 <li class=MsoNormal style='color:#333333;layout-grid-mode:both;'><span style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>自动在节点之间路由，以帮助你找到你想要的数据。</span></li>
 <li class=MsoNormal style='color:#333333;layout-grid-mode:both;'><span style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>无缝扩展或者恢复你的集群。</span></li>
</ul>

<h3><a name="_Toc416884148"><span style='font-family:宋体'>安装</span><span
lang=EN-US> Elasticsearch</span></a></h3>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:6.75pt;margin-left:
0cm;;'><span style='font-size:10.5pt;
color:#333333'>安装</span><span lang=EN-US style='font-size:10.5pt;font-family:
"Helvetica","sans-serif";color:#333333'> Elasticsearch </span><span
style='font-size:10.5pt;color:#333333'>只有一个要求，就是要安装最新版本的</span><span
lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif";
color:#333333'>JAVA</span><span style='font-size:10.5pt;color:#333333'>。你可以到官方网站下载它：</span><span
lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif";
color:#333333'>www.java.com.</span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:6.75pt;margin-left:
0cm;;'><span style='font-size:10.5pt;
color:#333333'>你可以在这里下载到最新版本的</span><span lang=EN-US style='font-size:10.5pt;
font-family:"Helvetica","sans-serif";color:#333333'> Elasticsearch</span><span
style='font-size:10.5pt;color:#333333'>：</span><span lang=EN-US
style='font-size:10.5pt;font-family:"Helvetica","sans-serif";color:#333333'>
elasticsearch.org/download.</span></p>

<pre style=';;'><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'>curl -L -O http://download.elasticsearch.org/PATH/TO/LATEST/</span></span><span
class=hljs-variable><b><span lang=EN-US style='font-family:Consolas;color:#3F6E74;
'>$VERSION</span></b></span><span class=line><span lang=EN-US
style='font-family:Consolas;color:black;'>.zip</span></span></pre><pre
style=';;'><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'>unzip elasticsearch-</span></span><span class=hljs-variable><b><span
lang=EN-US style='font-family:Consolas;color:#3F6E74;'>$VERSION</span></b></span><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'>.zip</span></span></pre><pre style=';;
'><span class=hljs-builtin><b><span lang=EN-US
style='font-family:Consolas;color:#5C2699;'>cd</span></b></span><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'>  elasticsearch-</span></span><span class=hljs-variable><b><span
lang=EN-US style='font-family:Consolas;color:#3F6E74;'>$VERSION</span></b></span></pre><pre
style=';;'><code><span
lang=EN-US style='font-family:Consolas;color:black;'>&nbsp;</span></code></pre>

<h3><a name="_Toc416884149"><span style='font-family:宋体'>运行</span><span
lang=EN-US> Elasticsearch</span></a></h3>

<pre style=';;'><span
class=line><span style='color:black;'>单机运行</span></span></pre><pre
style=';;'><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'>./bin/elasticsearch  -d (</span></span><span class=line><span
style='color:black;'>后台运行</span></span><span class=line><span
lang=EN-US style='font-family:Consolas;color:black;'>) </span></span></pre><pre
style=';;'><code><span
lang=EN-US style='font-family:Consolas;color:black;'>&nbsp;</span></code></pre><pre
style=';;'><span
class=line><span style='color:black;'>测试：</span></span></pre><pre
style=';;'><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'>[root</span></span><span class=hljs-annotation><span lang=EN-US
style='font-family:Consolas;color:#9B859D;'>@t</span></span><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'>-elastic1 ~]# curl </span></span><span class=hljs-symbol><span
lang=EN-US style='font-family:Consolas;color:#1C00CF;'>'http</span></span><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'>:</span></span><span class=hljs-comment><span lang=EN-US
style='font-family:Consolas;color:#006A00;'>//localhost:9200/?pretty'</span></span></pre><pre
style=';;'><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'>{</span></span></pre><pre style=';;
'><span class=line><span lang=EN-US style='font-family:
Consolas;color:black;'>  </span></span><span class=hljs-string><span
lang=EN-US style='font-family:Consolas;color:#C41A16;'>&quot;status&quot;</span></span><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'> : </span></span><span class=hljs-number><span lang=EN-US
style='font-family:Consolas;color:#1C00CF;'>200</span></span><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'>,</span></span></pre><pre style=';;
'><span class=line><span lang=EN-US style='font-family:
Consolas;color:black;'>  </span></span><span class=hljs-string><span
lang=EN-US style='font-family:Consolas;color:#C41A16;'>&quot;name&quot;</span></span><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'> : </span></span><span class=hljs-string><span lang=EN-US
style='font-family:Consolas;color:#C41A16;'>&quot;t-elastic1&quot;</span></span><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'>,</span></span></pre><pre style=';;
'><span class=line><span lang=EN-US style='font-family:
Consolas;color:black;'>  </span></span><span class=hljs-string><span
lang=EN-US style='font-family:Consolas;color:#C41A16;'>&quot;version&quot;</span></span><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'> : {</span></span></pre><pre style=';;
'><span class=line><span lang=EN-US style='font-family:
Consolas;color:black;'>    </span></span><span
class=hljs-string><span lang=EN-US style='font-family:Consolas;color:#C41A16;
'>&quot;number&quot;</span></span><span class=line><span
lang=EN-US style='font-family:Consolas;color:black;'> : </span></span><span
class=hljs-string><span lang=EN-US style='font-family:Consolas;color:#C41A16;
'>&quot;1.4.4&quot;</span></span><span class=line><span
lang=EN-US style='font-family:Consolas;color:black;'>,</span></span></pre><pre
style=';;'><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'>    </span></span><span class=hljs-string><span lang=EN-US
style='font-family:Consolas;color:#C41A16;'>&quot;build_hash&quot;</span></span><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'> : </span></span><span class=hljs-string><span lang=EN-US
style='font-family:Consolas;color:#C41A16;'>&quot;c88f77ffc81301dfa9dfd81ca2232f09588bd512&quot;</span></span><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'>,</span></span></pre><pre style=';;
'><span class=line><span lang=EN-US style='font-family:
Consolas;color:black;'>    </span></span><span
class=hljs-string><span lang=EN-US style='font-family:Consolas;color:#C41A16;
'>&quot;build_timestamp&quot;</span></span><span class=line><span
lang=EN-US style='font-family:Consolas;color:black;'> : </span></span><span
class=hljs-string><span lang=EN-US style='font-family:Consolas;color:#C41A16;
'>&quot;2015-02-19T13:05:36Z&quot;</span></span><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'>,</span></span></pre><pre style=';;
'><span class=line><span lang=EN-US style='font-family:
Consolas;color:black;'>    </span></span><span
class=hljs-string><span lang=EN-US style='font-family:Consolas;color:#C41A16;
'>&quot;build_snapshot&quot;</span></span><span class=line><span
lang=EN-US style='font-family:Consolas;color:black;'> : </span></span><span
class=hljs-keyword><b><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>false</span></b></span><span class=line><span lang=EN-US
style='font-family:Consolas;color:black;'>,</span></span></pre><pre
style=';;'><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'>    </span></span><span class=hljs-string><span lang=EN-US
style='font-family:Consolas;color:#C41A16;'>&quot;lucene_version&quot;</span></span><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'> : </span></span><span class=hljs-string><span lang=EN-US
style='font-family:Consolas;color:#C41A16;'>&quot;4.10.3&quot;</span></span></pre><pre
style=';;'><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'>  },</span></span></pre><pre style=';;
'><span class=line><span lang=EN-US style='font-family:
Consolas;color:black;'>  </span></span><span class=hljs-string><span
lang=EN-US style='font-family:Consolas;color:#C41A16;'>&quot;tagline&quot;</span></span><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'> : </span></span><span class=hljs-string><span lang=EN-US
style='font-family:Consolas;color:#C41A16;'>&quot;You Know, for Search&quot;</span></span></pre><pre
style=';;'><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'>}</span></span></pre><pre style=';;
'><code><span lang=EN-US style='font-family:Consolas;
color:black;'>&nbsp;</span></code></pre>

<h3><a name="_Toc416884150"><span lang=EN-US>elastic</span></a><span
style='font-family:宋体'>集群</span></h3>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:6.75pt;margin-left:
0cm;;'><span style='font-size:10.5pt;
color:#333333'>下面我们来配置</span><span lang=EN-US style='font-size:10.5pt;
font-family:"Helvetica","sans-serif";color:#333333'>elastic</span><span
style='font-size:10.5pt;color:#333333'>的集群</span></p>

<ul style='margin-top:0cm' type=disc>
 <li class=MsoNormal style='color:#333333;layout-grid-mode:both;'><span style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>集群的配置更为简单，只需要保证</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>cluster.name</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>一致就可以了</span></li>
 <li class=MsoNormal style='color:#333333;layout-grid-mode:both;'><span style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>集群之间的自动发现，默认是采用广播形式，不过为了避免非同一子网导致广播失效，最好配置成单播模式</span></li>
</ul>

<pre style=';;'><span
class=line><span lang=EN-US style='font-size:10.5pt;font-family:Consolas;
color:black;'> </span></span><span class=line><span
style='font-size:10.5pt;color:black;'>配置文件</span></span><span
class=line><span style='font-size:10.5pt;font-family:Consolas;color:black;
'> </span></span><span class=line><span style='font-size:10.5pt;
color:black;'>：</span></span><span class=line><span lang=EN-US
style='font-size:10.5pt;font-family:Consolas;color:black;'> config/</span></span><span
class=hljs-filename><span lang=EN-US style='font-size:10.5pt;font-family:Consolas;
color:black;'>elasticsearch.yml</span></span></pre><pre
style=';;'><span
class=hljs-filename><span lang=EN-US style='font-size:10.5pt;font-family:Consolas;
color:black;'>cluster.name</span></span><span class=line><span
lang=EN-US style='font-size:10.5pt;font-family:Consolas;color:black;'>: qb-elasticsearch</span></span></pre><pre style=';
;'><span class=hljs-filename><span
lang=EN-US style='font-size:10.5pt;font-family:Consolas;color:black;'>node.name</span></span><span class=line><span lang=EN-US
style='font-size:10.5pt;font-family:Consolas;color:black;'>: </span></span><span
class=hljs-string><span lang=EN-US style='font-size:10.5pt;font-family:Consolas;
color:#C41A16;'>&quot;t-elastic1&quot;</span></span></pre><pre
style=';;'><span
class=hljs-filename><span lang=EN-US style='font-size:10.5pt;font-family:Consolas;
color:black;'>node.master</span></span><span class=line><span
lang=EN-US style='font-size:10.5pt;font-family:Consolas;color:black;'>: true</span></span></pre><pre style=';;'><span class=hljs-filename><span lang=EN-US
style='font-size:10.5pt;font-family:Consolas;color:black;'>node.data</span></span><span
class=line><span lang=EN-US style='font-size:10.5pt;font-family:Consolas;
color:black;'>: true</span></span></pre><pre style='line-height:
16.8pt;;'><span class=hljs-filename><span
lang=EN-US style='font-size:10.5pt;font-family:Consolas;color:black;'>bootstrap.mlockall</span></span><span class=line><span lang=EN-US
style='font-size:10.5pt;font-family:Consolas;color:black;'>: true</span></span></pre><pre
style=';;'><span
class=hljs-filename><span lang=EN-US style='font-size:10.5pt;font-family:Consolas;
color:black;'>discovery.zen.ping.unicast.hosts</span></span><span
class=line><span lang=EN-US style='font-size:10.5pt;font-family:Consolas;
color:black;'>: [</span></span><span class=hljs-string><span
lang=EN-US style='font-size:10.5pt;font-family:Consolas;color:#C41A16;
'>&quot;t-elastic1&quot;</span></span><span class=line><span
lang=EN-US style='font-size:10.5pt;font-family:Consolas;color:black;'>,</span></span><span class=hljs-string><span lang=EN-US
style='font-size:10.5pt;font-family:Consolas;color:#C41A16;'>&quot;t-elastic2&quot;</span></span><span
class=line><span lang=EN-US style='font-size:10.5pt;font-family:Consolas;
color:black;'>,</span></span><span class=hljs-string><span
lang=EN-US style='font-size:10.5pt;font-family:Consolas;color:#C41A16;
'>&quot;t-elastic3&quot;</span></span><span class=line><span
lang=EN-US style='font-size:10.5pt;font-family:Consolas;color:black;'>]</span></span></pre><pre style=';;
'><code><span lang=EN-US style='font-size:10.5pt;
font-family:Consolas;color:black;'>&nbsp;</span></code></pre><pre
style=';;'><span
class=line><span style='font-size:10.5pt;color:black;'>说明</span></span><span
class=line><span lang=EN-US style='font-size:10.5pt;font-family:Consolas;
color:black;'>: </span></span><span class=hljs-number><span
lang=EN-US style='font-size:10.5pt;font-family:Consolas;color:#1C00CF;
'>3</span></span><span class=line><span style='font-size:10.5pt;
color:black;'>台</span></span><span class=line><span lang=EN-US
style='font-size:10.5pt;font-family:Consolas;color:black;'>elastic</span></span><span
class=line><span style='font-size:10.5pt;color:black;'>的集群，其中</span></span><span
class=line><span lang=EN-US style='font-size:10.5pt;font-family:Consolas;
color:black;'>t-elastic1</span></span><span class=line><span
style='font-size:10.5pt;color:black;'>做为</span></span><span
class=line><span lang=EN-US style='font-size:10.5pt;font-family:Consolas;
color:black;'>master</span></span><span class=line><span
style='font-size:10.5pt;color:black;'>，其他两台为</span></span><span
class=line><span lang=EN-US style='font-size:10.5pt;font-family:Consolas;
color:black;'>node</span></span></pre>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:6.75pt;margin-left:
0cm;;'><span lang=EN-US style='font-size:
10.5pt;font-family:"Helvetica","sans-serif";color:#333333'><img width=708
height=212 id="图片 16" src="2015-03-15-ELK日志分析系统.files/image008.gif"
alt="elastic_cluster"></span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:6.75pt;margin-left:
0cm;;'><span lang=EN-US style='font-size:
10.5pt;font-family:"Helvetica","sans-serif";color:#333333'>&nbsp;</span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:6.75pt;margin-left:
0cm;;'><b><span style='font-size:10.5pt;
color:#333333'>查看集群状态：</span></b></p>

<pre style=';;'><span
class=line><span style='font-size:10.5pt;color:black;'>在</span></span><span
class=line><span lang=EN-US style='font-size:10.5pt;font-family:Consolas;
color:black;'> Elasticsearch </span></span><span class=line><span
style='font-size:10.5pt;color:black;'>集群中可以监控统计很多信息，其中最重要的就是：集群健康</span></span><span
class=line><span lang=EN-US style='font-size:10.5pt;font-family:Consolas;
color:black;'>(cluster health)</span></span><span class=line><span
style='font-size:10.5pt;color:black;'>。它的</span></span><span
class=line><span lang=EN-US style='font-size:10.5pt;font-family:Consolas;
color:black;'> status </span></span><span class=line><span
style='font-size:10.5pt;color:black;'>有</span></span><span
class=line><span lang=EN-US style='font-size:10.5pt;font-family:Consolas;
color:black;'> green</span></span><span class=line><span
style='font-size:10.5pt;color:black;'>、</span></span><span
class=line><span lang=EN-US style='font-size:10.5pt;font-family:Consolas;
color:black;'>yellow</span></span><span class=line><span
style='font-size:10.5pt;color:black;'>、</span></span><span
class=line><span lang=EN-US style='font-size:10.5pt;font-family:Consolas;
color:black;'>red </span></span><span class=line><span
style='font-size:10.5pt;color:black;'>三种；</span></span></pre><pre
style=';;'><code><span
lang=EN-US style='font-size:10.5pt;font-family:Consolas;color:black;'>&nbsp;</span></code></pre><pre style=';;'><span class=line><span lang=EN-US style='font-size:
10.5pt;font-family:Consolas;color:black;'>curl http:</span></span><span
class=hljs-comment><span lang=EN-US style='font-size:10.5pt;font-family:Consolas;
color:#006A00;'>//localhost:9200/_cluster/health?pretty</span></span></pre><pre
style=';;'><span
class=line><span lang=EN-US style='font-size:10.5pt;font-family:Consolas;
color:black;'>{</span></span></pre><pre style='line-height:
16.8pt;;'><span class=line><span
lang=EN-US style='font-size:10.5pt;font-family:Consolas;color:black;'>  </span></span><span class=hljs-string><span lang=EN-US
style='font-size:10.5pt;font-family:Consolas;color:#C41A16;'>&quot;cluster_name&quot;</span></span><span
class=line><span lang=EN-US style='font-size:10.5pt;font-family:Consolas;
color:black;'> : </span></span><span class=hljs-string><span
lang=EN-US style='font-size:10.5pt;font-family:Consolas;color:#C41A16;
'>&quot;qb-elasticsearch&quot;</span></span><span class=line><span
lang=EN-US style='font-size:10.5pt;font-family:Consolas;color:black;'>,</span></span></pre><pre style=';;
'><span class=line><span lang=EN-US style='font-size:10.5pt;
font-family:Consolas;color:black;'>  </span></span><span
class=hljs-string><span lang=EN-US style='font-size:10.5pt;font-family:Consolas;
color:#C41A16;'>&quot;status&quot;</span></span><span
class=line><span lang=EN-US style='font-size:10.5pt;font-family:Consolas;
color:black;'> : </span></span><span class=hljs-string><span
lang=EN-US style='font-size:10.5pt;font-family:Consolas;color:#C41A16;
'>&quot;green&quot;</span></span><span class=line><span
lang=EN-US style='font-size:10.5pt;font-family:Consolas;color:black;'>,</span></span></pre><pre style=';;
'><span class=line><span lang=EN-US style='font-size:10.5pt;
font-family:Consolas;color:black;'>  </span></span><span
class=hljs-string><span lang=EN-US style='font-size:10.5pt;font-family:Consolas;
color:#C41A16;'>&quot;timed_out&quot;</span></span><span
class=line><span lang=EN-US style='font-size:10.5pt;font-family:Consolas;
color:black;'> : </span></span><span class=hljs-literal><span
lang=EN-US style='font-size:10.5pt;font-family:Consolas;color:#AA0D91;
'>false</span></span><span class=line><span lang=EN-US
style='font-size:10.5pt;font-family:Consolas;color:black;'>,</span></span></pre><pre
style=';;'><span
class=line><span lang=EN-US style='font-size:10.5pt;font-family:Consolas;
color:black;'>  </span></span><span class=hljs-string><span
lang=EN-US style='font-size:10.5pt;font-family:Consolas;color:#C41A16;
'>&quot;number_of_nodes&quot;</span></span><span class=line><span
lang=EN-US style='font-size:10.5pt;font-family:Consolas;color:black;'> : </span></span><span class=hljs-number><span lang=EN-US
style='font-size:10.5pt;font-family:Consolas;color:#1C00CF;'>3</span></span><span
class=line><span lang=EN-US style='font-size:10.5pt;font-family:Consolas;
color:black;'>,</span></span></pre><pre style='line-height:
16.8pt;;'><span class=line><span
lang=EN-US style='font-size:10.5pt;font-family:Consolas;color:black;'>  </span></span><span class=hljs-string><span lang=EN-US
style='font-size:10.5pt;font-family:Consolas;color:#C41A16;'>&quot;number_of_data_nodes&quot;</span></span><span
class=line><span lang=EN-US style='font-size:10.5pt;font-family:Consolas;
color:black;'> : </span></span><span class=hljs-number><span
lang=EN-US style='font-size:10.5pt;font-family:Consolas;color:#1C00CF;
'>3</span></span><span class=line><span lang=EN-US
style='font-size:10.5pt;font-family:Consolas;color:black;'>,</span></span></pre><pre
style=';;'><span
class=line><span lang=EN-US style='font-size:10.5pt;font-family:Consolas;
color:black;'>  </span></span><span class=hljs-string><span
lang=EN-US style='font-size:10.5pt;font-family:Consolas;color:#C41A16;
'>&quot;active_primary_shards&quot;</span></span><span
class=line><span lang=EN-US style='font-size:10.5pt;font-family:Consolas;
color:black;'> : </span></span><span class=hljs-number><span
lang=EN-US style='font-size:10.5pt;font-family:Consolas;color:#1C00CF;
'>59</span></span><span class=line><span lang=EN-US
style='font-size:10.5pt;font-family:Consolas;color:black;'>,</span></span></pre><pre
style=';;'><span
class=line><span lang=EN-US style='font-size:10.5pt;font-family:Consolas;
color:black;'>  </span></span><span class=hljs-string><span
lang=EN-US style='font-size:10.5pt;font-family:Consolas;color:#C41A16;
'>&quot;active_shards&quot;</span></span><span class=line><span
lang=EN-US style='font-size:10.5pt;font-family:Consolas;color:black;'> : </span></span><span class=hljs-number><span lang=EN-US
style='font-size:10.5pt;font-family:Consolas;color:#1C00CF;'>118</span></span><span
class=line><span lang=EN-US style='font-size:10.5pt;font-family:Consolas;
color:black;'>,</span></span></pre><pre style='line-height:
16.8pt;;'><span class=line><span
lang=EN-US style='font-size:10.5pt;font-family:Consolas;color:black;'>  </span></span><span class=hljs-string><span lang=EN-US
style='font-size:10.5pt;font-family:Consolas;color:#C41A16;'>&quot;relocating_shards&quot;</span></span><span
class=line><span lang=EN-US style='font-size:10.5pt;font-family:Consolas;
color:black;'> : </span></span><span class=hljs-number><span
lang=EN-US style='font-size:10.5pt;font-family:Consolas;color:#1C00CF;
'>0</span></span><span class=line><span lang=EN-US
style='font-size:10.5pt;font-family:Consolas;color:black;'>,</span></span></pre><pre
style=';;'><span
class=line><span lang=EN-US style='font-size:10.5pt;font-family:Consolas;
color:black;'>  </span></span><span class=hljs-string><span
lang=EN-US style='font-size:10.5pt;font-family:Consolas;color:#C41A16;
'>&quot;initializing_shards&quot;</span></span><span
class=line><span lang=EN-US style='font-size:10.5pt;font-family:Consolas;
color:black;'> : </span></span><span class=hljs-number><span
lang=EN-US style='font-size:10.5pt;font-family:Consolas;color:#1C00CF;
'>0</span></span><span class=line><span lang=EN-US
style='font-size:10.5pt;font-family:Consolas;color:black;'>,</span></span></pre><pre
style=';;'><span
class=line><span lang=EN-US style='font-size:10.5pt;font-family:Consolas;
color:black;'>  </span></span><span class=hljs-string><span
lang=EN-US style='font-size:10.5pt;font-family:Consolas;color:#C41A16;
'>&quot;unassigned_shards&quot;</span></span><span class=line><span
lang=EN-US style='font-size:10.5pt;font-family:Consolas;color:black;'> : </span></span><span class=hljs-number><span lang=EN-US
style='font-size:10.5pt;font-family:Consolas;color:#1C00CF;'>0</span></span></pre><pre
style=';;'><span
class=line><span lang=EN-US style='font-size:10.5pt;font-family:Consolas;
color:black;'>}</span></span></pre><pre style='line-height:
16.8pt;;'><code><span lang=EN-US
style='font-family:Consolas;color:black;'>&nbsp;</span></code></pre>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:6.75pt;margin-left:
0cm;;'><span lang=EN-US style='font-size:
10.5pt;font-family:"Helvetica","sans-serif";color:#333333'>status </span><span
style='font-size:10.5pt;color:#333333'>可以告诉我们当前集群是否处于一个可用的状态。三种颜色分别代表：</span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width=1140
 style='width:855.0pt;;border-collapse:collapse;border:none'>
 <tr>
  <td valign=top style='border:solid #DDDDDD 1.0pt;background:#EEEEEE;
  padding:6.0pt 6.0pt 6.0pt 6.0pt'>
  <p class=MsoNormal style='margin-bottom:13.5pt'><b><span style='font-size:
  10.5pt;font-family:"微软雅黑","sans-serif";color:#333333'>状态</span></b></p>
  </td>
  <td valign=top style='border:solid #DDDDDD 1.0pt;border-left:none;background:
  #EEEEEE;padding:6.0pt 6.0pt 6.0pt 6.0pt'>
  <p class=MsoNormal style='margin-bottom:13.5pt'><b><span style='font-size:
  10.5pt;font-family:"微软雅黑","sans-serif";color:#333333'>意义</span></b></p>
  </td>
 </tr>
 <tr>
  <td valign=top style='border:solid #DDDDDD 1.0pt;border-top:none;padding:
  6.0pt 6.0pt 6.0pt 6.0pt'>
  <p class=MsoNormal style='margin-bottom:13.5pt'><span lang=EN-US
  style='font-size:10.5pt;font-family:"Helvetica","sans-serif";color:#333333'>green</span></p>
  </td>
  <td valign=top style='border-top:none;border-left:none;border-bottom:solid #DDDDDD 1.0pt;
  border-right:solid #DDDDDD 1.0pt;padding:6.0pt 6.0pt 6.0pt 6.0pt'>
  <p class=MsoNormal style='margin-bottom:13.5pt'><span style='font-size:10.5pt;
  font-family:"微软雅黑","sans-serif";color:#333333'>所有主分片和从分片都可用</span></p>
  </td>
 </tr>
 <tr>
  <td valign=top style='border:solid #DDDDDD 1.0pt;border-top:none;padding:
  6.0pt 6.0pt 6.0pt 6.0pt'>
  <p class=MsoNormal style='margin-bottom:13.5pt'><span lang=EN-US
  style='font-size:10.5pt;font-family:"Helvetica","sans-serif";color:#333333'>yellow</span></p>
  </td>
  <td valign=top style='border-top:none;border-left:none;border-bottom:solid #DDDDDD 1.0pt;
  border-right:solid #DDDDDD 1.0pt;padding:6.0pt 6.0pt 6.0pt 6.0pt'>
  <p class=MsoNormal style='margin-bottom:13.5pt'><span style='font-size:10.5pt;
  font-family:"微软雅黑","sans-serif";color:#333333'>所有主分片可用，但存在不可用的从分片</span></p>
  </td>
 </tr>
 <tr>
  <td valign=top style='border:solid #DDDDDD 1.0pt;border-top:none;padding:
  6.0pt 6.0pt 6.0pt 6.0pt'>
  <p class=MsoNormal style='margin-bottom:13.5pt'><span lang=EN-US
  style='font-size:10.5pt;font-family:"Helvetica","sans-serif";color:#333333'>red</span></p>
  </td>
  <td valign=top style='border-top:none;border-left:none;border-bottom:solid #DDDDDD 1.0pt;
  border-right:solid #DDDDDD 1.0pt;padding:6.0pt 6.0pt 6.0pt 6.0pt'>
  <p class=MsoNormal style='margin-bottom:13.5pt'><span style='font-size:10.5pt;
  font-family:"微软雅黑","sans-serif";color:#333333'>存在不可用的主要分片</span></p>
  </td>
 </tr>
</table>

<h3><a name="_Toc416884151"><span lang=EN-US>elastic </span></a><span
style='font-family:宋体'>权限控制</span></h3>

<h6 style='margin-top:0cm;margin-right:0cm;margin-bottom:6.75pt;margin-left:
0cm;'><span style='font-size:9.0pt;line-height:133%;font-family:
宋体;color:#888888;text-transform:uppercase;font-weight:normal'>先来看下</span><span
lang=EN-US style='font-size:9.0pt;line-height:133%;font-family:"Helvetica","sans-serif";
color:#888888;text-transform:uppercase;font-weight:normal'>ELASTIC</span><span
style='font-size:9.0pt;line-height:133%;font-family:宋体;color:#888888;
text-transform:uppercase;font-weight:normal'>的</span><span lang=EN-US
style='font-size:9.0pt;line-height:133%;font-family:"Helvetica","sans-serif";
color:#888888;text-transform:uppercase;font-weight:normal'>API</span></h6>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:6.75pt;margin-left:
0cm;;'><span lang=EN-US style='font-size:
10.5pt;font-family:"Helvetica","sans-serif";color:#333333'>elastic</span><span
style='font-size:10.5pt;color:#333333'>是通过</span><span lang=EN-US
style='font-size:10.5pt;font-family:"Helvetica","sans-serif";color:#333333'>
HTTP </span><span style='font-size:10.5pt;color:#333333'>向</span><span
lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif";
color:#333333'> RESTful API </span><span style='font-size:10.5pt;color:#333333'>传送</span><span
lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif";
color:#333333'> json</span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:6.75pt;margin-left:
0cm;;'><span style='font-size:10.5pt;
color:#333333'>其他的语言可以通过</span><span lang=EN-US style='font-size:10.5pt;
font-family:"Helvetica","sans-serif";color:#333333'>9200</span><span
style='font-size:10.5pt;color:#333333'>端口与</span><span lang=EN-US
style='font-size:10.5pt;font-family:"Helvetica","sans-serif";color:#333333'>
Elasticsearch </span><span style='font-size:10.5pt;color:#333333'>的</span><span
lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif";
color:#333333'> RESTful API </span><span style='font-size:10.5pt;color:#333333'>进行通信。事实上，如你所见，你甚至可以使用行命令</span><span
lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif";
color:#333333'> curl </span><span style='font-size:10.5pt;color:#333333'>来与</span><span
lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif";
color:#333333'> Elasticsearch </span><span style='font-size:10.5pt;color:#333333'>通信。</span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:6.75pt;margin-left:
0cm;;'><span style='font-size:10.5pt;
color:#333333'>向</span><span lang=EN-US style='font-size:10.5pt;font-family:
"Helvetica","sans-serif";color:#333333'> Elasticsearch </span><span
style='font-size:10.5pt;color:#333333'>发出的请求和其他所有的</span><span lang=EN-US
style='font-size:10.5pt;font-family:"Helvetica","sans-serif";color:#333333'>
HTTP </span><span style='font-size:10.5pt;color:#333333'>请求的组成部分是一致的。例如，计算集群中文件的数量，我们就可以使用：</span></p>

<pre style=';;'><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'>curl -XGET 'http:</span></span><span class=hljs-comment><span
lang=EN-US style='font-family:Consolas;color:#006A00;'>//localhost:9200/_count?pretty' -d '</span></span></pre><pre
style=';;'><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'>{  </span></span></pre><pre style=';;
'><span class=line><span lang=EN-US style='font-family:
Consolas;color:black;'>    </span></span><span
class=hljs-string><span lang=EN-US style='font-family:Consolas;color:#C41A16;
'>&quot;query&quot;</span></span><span class=line><span
lang=EN-US style='font-family:Consolas;color:black;'>: {</span></span></pre><pre
style=';;'><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'>        </span></span><span class=hljs-string><span lang=EN-US
style='font-family:Consolas;color:#C41A16;'>&quot;match_all&quot;</span></span><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'>: {}</span></span></pre><pre style=';;
'><span class=line><span lang=EN-US style='font-family:
Consolas;color:black;'>    }</span></span></pre><pre
style=';;'><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'>}</span></span></pre><pre style=';;
'><span class=line><span lang=EN-US style='font-family:
Consolas;color:black;'>'</span></span></pre>

<ul style='margin-top:0cm' type=disc>
 <li class=MsoNormal style='color:#333333;layout-grid-mode:both;'><span style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>相应的</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>
     HTTP </span><span style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>请求方法</span><span
     style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'> </span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>或者</span><span
     style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'> </span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>变量</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>
     : GET, POST, PUT, HEAD </span><span style='font-size:10.5pt;font-family:
     "微软雅黑","sans-serif"'>或者</span><span lang=EN-US style='font-size:10.5pt;
     font-family:"Helvetica","sans-serif"'> DELETE</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>。</span></li>
 <li class=MsoNormal style='color:#333333;layout-grid-mode:both;'><span style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>集群中任意一个节点的访问协议、主机名以及端口。</span></li>
 <li class=MsoNormal style='color:#333333;layout-grid-mode:both;'><span style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>请求的路径。</span></li>
 <li class=MsoNormal style='color:#333333;layout-grid-mode:both;'><span style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>任意一个查询后再加上</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>
     ?pretty </span><span style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>就可以生成</span><span
     style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'> </span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>更加美观</span><span
     style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'> </span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>的</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>JSON</span><span
     style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>反馈，以增强可读性。</span></li>
 <li class=MsoNormal style='color:#333333;layout-grid-mode:both;'><span style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>一个</span><span
     lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif"'>
     JSON </span><span style='font-size:10.5pt;font-family:"微软雅黑","sans-serif"'>编码的请求主体（如果需要的话）。</span></li>
</ul>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:6.75pt;margin-left:
0cm;;'><span lang=EN-US style='font-size:
10.5pt;font-family:"Helvetica","sans-serif";color:#333333'>Elasticsearch </span><span
style='font-size:10.5pt;color:#333333'>将会返回一个</span><span lang=EN-US
style='font-size:10.5pt;font-family:"Helvetica","sans-serif";color:#333333'>
HTTP </span><span style='font-size:10.5pt;color:#333333'>状态码类似于</span><span
lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif";
color:#333333'> '200 OK'</span><span style='font-size:10.5pt;color:#333333'>，以及一个</span><span
lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif";
color:#333333'> JSON </span><span style='font-size:10.5pt;color:#333333'>格式的主体（除了单纯的</span><span
lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif";
color:#333333'> 'HEAD' </span><span style='font-size:10.5pt;color:#333333'>请求），上面的请求会得到下方的</span><span
lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif";
color:#333333'> JSON </span><span style='font-size:10.5pt;color:#333333'>主体：</span></p>

<pre style=';;'><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'>{</span></span></pre><pre style=';;
'><span class=line><span lang=EN-US style='font-family:
Consolas;color:black;'>    &quot;</span></span><span
class=hljs-attribute><span lang=EN-US style='font-family:Consolas;color:black;
'>count</span></span><span class=line><span lang=EN-US
style='font-family:Consolas;color:black;'>&quot; : </span></span><span
class=hljs-number><span lang=EN-US style='font-family:Consolas;color:#1C00CF;
'>0</span></span><span class=line><span lang=EN-US
style='font-family:Consolas;color:black;'>,</span></span></pre><pre
style=';;'><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'>    &quot;</span></span><span class=hljs-attribute><span lang=EN-US
style='font-family:Consolas;color:black;'>_shards</span></span><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'>&quot; : </span></span><span class=hljs-value><span lang=EN-US
style='font-family:Consolas;color:black;'>{</span></span></pre><pre
style=';;'><span
class=hljs-value><span lang=EN-US style='font-family:Consolas;color:black;
'>        &quot;</span></span><span class=hljs-attribute><span
lang=EN-US style='font-family:Consolas;color:black;'>total</span></span><span
class=hljs-value><span lang=EN-US style='font-family:Consolas;color:black;
'>&quot; : </span></span><span class=hljs-number><span
lang=EN-US style='font-family:Consolas;color:#1C00CF;'>5</span></span><span
class=hljs-value><span lang=EN-US style='font-family:Consolas;color:black;
'>,</span></span></pre><pre style=';
;'><span class=hljs-value><span lang=EN-US
style='font-family:Consolas;color:black;'>        &quot;</span></span><span
class=hljs-attribute><span lang=EN-US style='font-family:Consolas;color:black;
'>successful</span></span><span class=hljs-value><span
lang=EN-US style='font-family:Consolas;color:black;'>&quot; : </span></span><span
class=hljs-number><span lang=EN-US style='font-family:Consolas;color:#1C00CF;
'>5</span></span><span class=hljs-value><span lang=EN-US
style='font-family:Consolas;color:black;'>,</span></span></pre><pre
style=';;'><span
class=hljs-value><span lang=EN-US style='font-family:Consolas;color:black;
'>        &quot;</span></span><span class=hljs-attribute><span
lang=EN-US style='font-family:Consolas;color:black;'>failed</span></span><span
class=hljs-value><span lang=EN-US style='font-family:Consolas;color:black;
'>&quot; : </span></span><span class=hljs-number><span
lang=EN-US style='font-family:Consolas;color:#1C00CF;'>0</span></span></pre><pre
style=';;'><span
class=hljs-value><span lang=EN-US style='font-family:Consolas;color:black;
'>    }</span></span></pre><pre style=';
;'><span class=line><span lang=EN-US
style='font-family:Consolas;color:black;'>}</span></span></pre><pre
style=';;'><code><span
lang=EN-US style='font-family:Consolas;color:black;'>&nbsp;</span></code></pre>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:6.75pt;margin-left:
0cm;;'><span style='font-size:10.5pt;
color:#333333'>几乎只要能连接上</span><span lang=EN-US style='font-size:10.5pt;
font-family:"Helvetica","sans-serif";color:#333333'>elastic </span><span
style='font-size:10.5pt;color:#333333'>的</span><span lang=EN-US
style='font-size:10.5pt;font-family:"Helvetica","sans-serif";color:#333333'>http
9200</span><span style='font-size:10.5pt;color:#333333'>端口，所有操作（增、删、改、查）都可以进行，自身没有任何权限控制</span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:6.75pt;margin-left:
0cm;;'><span style='font-size:10.5pt;
color:#333333'>下面我们通过第三方插件形式对</span><span lang=EN-US style='font-size:10.5pt;
font-family:"Helvetica","sans-serif";color:#333333'>api</span><span
style='font-size:10.5pt;color:#333333'>进行权限控制</span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:6.75pt;margin-left:
0cm;;'><span lang=EN-US style='font-size:
10.5pt;font-family:"Helvetica","sans-serif";color:#333333'>&nbsp;</span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:6.75pt;margin-left:
0cm;;'><b><span style='font-size:10.5pt;
color:#333333'>官方插件：</span></b></p>

<pre style=';;'><span
lang=EN-US><a href="https://www.elastic.co/downloads/shield"><span
style='font-family:Consolas;'>https://www.elastic.<b>co</b>/downloads/shield</span></a></span></pre><pre
style=';;'><code><span
lang=EN-US style='font-family:Consolas;color:black;'>&nbsp;</span></code></pre>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:6.75pt;margin-left:
0cm;;'><b><span style='font-size:10.5pt;
color:#333333'>安装使用很简单：</span></b></p>

<pre style=';;'><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'>Security for Elasticsearch, in Five Easy Steps</span></span></pre><pre
style=';;'><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'>Step 1: </span></span><span class=hljs-keyword><b><span lang=EN-US
style='font-family:Consolas;color:#AA0D91;'>Install</span></b></span><span
class=hljs-operator><span lang=EN-US style='font-family:Consolas;color:black;
'> </span></span><span class=hljs-keyword><b><span lang=EN-US
style='font-family:Consolas;color:#AA0D91;'>bin</span></b></span><span
class=hljs-operator><span lang=EN-US style='font-family:Consolas;color:black;
'>/</span></span><span class=hljs-keyword><b><span lang=EN-US
style='font-family:Consolas;color:#AA0D91;'>plugin</span></b></span><span
class=hljs-operator><span lang=EN-US style='font-family:Consolas;color:black;
'> -i elasticsearch/license/latestbin/</span></span><span
class=hljs-keyword><b><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>plugin</span></b></span><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'> -i elasticsearch/shield/latest</span></span></pre><pre
style=';;'><span
class=hljs-operator><span lang=EN-US style='font-family:Consolas;color:black;
'>Step </span></span><span class=hljs-number><span lang=EN-US
style='font-family:Consolas;color:#1C00CF;'>2</span></span><span
class=hljs-operator><span lang=EN-US style='font-family:Consolas;color:black;
'>: </span></span><span class=hljs-keyword><b><span lang=EN-US
style='font-family:Consolas;color:#AA0D91;'>Start</span></b></span><span
class=hljs-operator><span lang=EN-US style='font-family:Consolas;color:black;
'> Elasticsearch </span></span><span class=hljs-keyword><b><span
lang=EN-US style='font-family:Consolas;color:#AA0D91;'>bin</span></b></span><span
class=hljs-operator><span lang=EN-US style='font-family:Consolas;color:black;
'>/elasticsearch</span></span></pre><pre style='line-height:
16.8pt;;'><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'>Step </span></span><span
class=hljs-number><span lang=EN-US style='font-family:Consolas;color:#1C00CF;
'>3</span></span><span class=hljs-operator><span lang=EN-US
style='font-family:Consolas;color:black;'>: </span></span><span
class=hljs-keyword><b><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>Add</span></b></span><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'> an admin </span></span><span
class=hljs-keyword><b><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>user</span></b></span><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'>   </span></span><span
class=hljs-keyword><b><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>bin</span></b></span><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'>/shield/esusers useradd es_admin -r admin</span></span></pre><pre
style=';;'><span
class=hljs-operator><span lang=EN-US style='font-family:Consolas;color:black;
'>Step </span></span><span class=hljs-number><span lang=EN-US
style='font-family:Consolas;color:#1C00CF;'>4</span></span><span
class=hljs-operator><span lang=EN-US style='font-family:Consolas;color:black;
'>: Try it out - secured    curl -XGET </span></span><span
class=hljs-string><span lang=EN-US style='font-family:Consolas;color:#C41A16;
'>'http://localhost:9200/'</span></span></pre><pre
style=';;'><span
class=hljs-operator><span lang=EN-US style='font-family:Consolas;color:black;
'>Step </span></span><span class=hljs-number><span lang=EN-US
style='font-family:Consolas;color:#1C00CF;'>5</span></span><span
class=hljs-operator><span lang=EN-US style='font-family:Consolas;color:black;
'>: </span></span><span class=hljs-keyword><b><span lang=EN-US
style='font-family:Consolas;color:#AA0D91;'>And</span></b></span><span
class=hljs-operator><span lang=EN-US style='font-family:Consolas;color:black;
'> </span></span><span class=hljs-keyword><b><span lang=EN-US
style='font-family:Consolas;color:#AA0D91;'>with</span></b></span><span
class=hljs-operator><span lang=EN-US style='font-family:Consolas;color:black;
'> a </span></span><span class=hljs-keyword><b><span
lang=EN-US style='font-family:Consolas;color:#AA0D91;'>user</span></b></span><span
class=hljs-operator><span lang=EN-US style='font-family:Consolas;color:black;
'> curl -u es_admin -XGET </span></span><span
class=hljs-string><span lang=EN-US style='font-family:Consolas;color:#C41A16;
'>'http://localhost:9200/'</span></span></pre><pre
style=';;'><span
class=hljs-operator><span lang=EN-US style='font-family:Consolas;color:black;
'>&nbsp;</span></span></pre>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:6.75pt;margin-left:
0cm;;'><b><span style='font-size:10.5pt;
color:#333333'>配置文件存放路径：</span></b><b><span lang=EN-US style='font-size:10.5pt;
font-family:"Helvetica","sans-serif";color:#333333'>config/shield/</span></b></p>

<pre style=';;'><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'># All cluster rights</span></span></pre><pre style=';
;'><span class=line><span lang=EN-US
style='font-family:Consolas;color:black;'># All operations on all indices</span></span></pre><pre
style=';;'><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'>admin:</span></span></pre><pre style=';;'><span class=line><span lang=EN-US style='font-family:
Consolas;color:black;'>  cluster: all</span></span></pre><pre
style=';;'><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'>  indices:</span></span></pre><pre style=';;'><span class=line><span lang=EN-US style='font-family:
Consolas;color:black;'>    '*': all</span></span></pre><pre
style=';;'><code><span
lang=EN-US style='font-family:Consolas;color:black;'>&nbsp;</span></code></pre><pre
style=';;'><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'># monitoring cluster privileges</span></span></pre><pre
style=';;'><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'># All operations on all indices</span></span></pre><pre
style=';;'><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'>power_user:</span></span></pre><pre style=';
;'><span class=line><span lang=EN-US
style='font-family:Consolas;color:black;'>  cluster: monitor</span></span></pre><pre
style=';;'><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'>  indices:</span></span></pre><pre style=';;'><span class=line><span lang=EN-US style='font-family:
Consolas;color:black;'>    '*': all</span></span></pre><pre
style=';;'><code><span
lang=EN-US style='font-family:Consolas;color:black;'>&nbsp;</span></code></pre><pre
style=';;'><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'># Read-only operations on indices</span></span></pre><pre
style=';;'><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'>user:</span></span></pre><pre style=';;
'><span class=line><span lang=EN-US style='font-family:
Consolas;color:black;'>  indices:</span></span></pre><pre
style=';;'><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'>    '*': read</span></span></pre><pre style=';
;'><code><span lang=EN-US style='font-family:
Consolas;color:black;'>&nbsp;</span></code></pre><pre
style=';;'><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'># Defines the required permissions for trasport clients</span></span></pre><pre
style=';;'><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'>transport_client:</span></span></pre><pre style=';
;'><span class=line><span lang=EN-US
style='font-family:Consolas;color:black;'>  cluster:</span></span></pre><pre
style=';;'><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'>    - cluster:monitor/nodes/info</span></span></pre><pre
style=';;'><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'>    #uncomment the following for sniffing</span></span></pre><pre
style=';;'><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'>    #- cluster:monitor/state</span></span></pre><pre style='line-height:
16.8pt;;'><code><span lang=EN-US
style='font-family:Consolas;color:black;'>&nbsp;</span></code></pre><pre
style=';;'><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'># The required role for kibana 3 users</span></span></pre><pre
style=';;'><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'>kibana3:</span></span></pre><pre style=';;'><span class=line><span lang=EN-US style='font-family:
Consolas;color:black;'>  cluster: cluster:monitor/nodes/info</span></span></pre><pre
style=';;'><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'>  indices:</span></span></pre><pre style=';;'><span class=line><span lang=EN-US style='font-family:
Consolas;color:black;'>    '*': indices:data/read/search, indices:data/read/get, indices:admin/get</span></span></pre><pre
style=';;'><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'>    'kibana-int': indices:data/read/search, indices:data/read/get, indices:data/write/</span></span><span
class=hljs-keyword><b><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>delete</span></b></span><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'>, indices:</span></span><span
class=hljs-keyword><b><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>data</span></b></span><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'>/</span></span><span
class=hljs-keyword><b><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>write</span></b></span><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'>/</span></span><span
class=hljs-keyword><b><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>index</span></b></span><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'>, create_index</span></span></pre><pre
style=';;'><span
class=hljs-operator><span lang=EN-US style='font-family:Consolas;color:black;
'>&nbsp;</span></span></pre><pre style=';
;'><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'># The required permissions </span></span><span
class=hljs-keyword><b><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>for</span></b></span><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'> kibana </span></span><span
class=hljs-number><span lang=EN-US style='font-family:Consolas;color:#1C00CF;
'>4</span></span><span class=hljs-operator><span lang=EN-US
style='font-family:Consolas;color:black;'> users.</span></span></pre><pre
style=';;'><span
class=hljs-operator><span lang=EN-US style='font-family:Consolas;color:black;
'>kibana4:</span></span></pre><pre style=';
;'><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'>  cluster:</span></span></pre><pre
style=';;'><span
class=hljs-operator><span lang=EN-US style='font-family:Consolas;color:black;
'>      - cluster:monitor/nodes/info</span></span></pre><pre
style=';;'><span
class=hljs-operator><span lang=EN-US style='font-family:Consolas;color:black;
'>      - cluster:monitor/health</span></span></pre><pre
style=';;'><span
class=hljs-operator><span lang=EN-US style='font-family:Consolas;color:black;
'>  indices:</span></span></pre><pre style=';
;'><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'>    </span></span><span
class=hljs-string><span lang=EN-US style='font-family:Consolas;color:#C41A16;
'>'*'</span></span><span class=hljs-operator><span lang=EN-US
style='font-family:Consolas;color:black;'>:</span></span></pre><pre
style=';;'><span
class=hljs-operator><span lang=EN-US style='font-family:Consolas;color:black;
'>      - indices:admin/mappings/</span></span><span
class=hljs-keyword><b><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>fields</span></b></span><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'>/</span></span><span
class=hljs-keyword><b><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>get</span></b></span></pre><pre style=';
;'><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'>      - indices:admin/validate/</span></span><span
class=hljs-keyword><b><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>query</span></b></span></pre><pre style=';
;'><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'>      - indices:</span></span><span
class=hljs-keyword><b><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>data</span></b></span><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'>/</span></span><span
class=hljs-keyword><b><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>read</span></b></span><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'>/search</span></span></pre><pre
style=';;'><span
class=hljs-operator><span lang=EN-US style='font-family:Consolas;color:black;
'>      - indices:</span></span><span class=hljs-keyword><b><span
lang=EN-US style='font-family:Consolas;color:#AA0D91;'>data</span></b></span><span
class=hljs-operator><span lang=EN-US style='font-family:Consolas;color:black;
'>/</span></span><span class=hljs-keyword><b><span lang=EN-US
style='font-family:Consolas;color:#AA0D91;'>read</span></b></span><span
class=hljs-operator><span lang=EN-US style='font-family:Consolas;color:black;
'>/msearch</span></span></pre><pre style=';
;'><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'>      - indices:admin/</span></span><span
class=hljs-keyword><b><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>get</span></b></span></pre><pre style=';
;'><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'>    </span></span><span
class=hljs-string><span lang=EN-US style='font-family:Consolas;color:#C41A16;
'>'.kibana'</span></span><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'>:</span></span></pre><pre
style=';;'><span
class=hljs-operator><span lang=EN-US style='font-family:Consolas;color:black;
'>      - indices:admin/</span></span><span class=hljs-keyword><b><span
lang=EN-US style='font-family:Consolas;color:#AA0D91;'>exists</span></b></span></pre><pre
style=';;'><span
class=hljs-operator><span lang=EN-US style='font-family:Consolas;color:black;
'>      - indices:admin/mapping/put</span></span></pre><pre
style=';;'><span
class=hljs-operator><span lang=EN-US style='font-family:Consolas;color:black;
'>      - indices:admin/mappings/</span></span><span
class=hljs-keyword><b><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>fields</span></b></span><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'>/</span></span><span
class=hljs-keyword><b><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>get</span></b></span></pre><pre style=';
;'><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'>      - indices:admin/refresh</span></span></pre><pre
style=';;'><span
class=hljs-operator><span lang=EN-US style='font-family:Consolas;color:black;
'>      - indices:admin/validate/</span></span><span
class=hljs-keyword><b><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>query</span></b></span></pre><pre style=';
;'><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'>      - indices:</span></span><span
class=hljs-keyword><b><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>data</span></b></span><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'>/</span></span><span
class=hljs-keyword><b><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>read</span></b></span><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'>/</span></span><span
class=hljs-keyword><b><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>get</span></b></span></pre><pre style=';
;'><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'>      - indices:</span></span><span
class=hljs-keyword><b><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>data</span></b></span><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'>/</span></span><span
class=hljs-keyword><b><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>read</span></b></span><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'>/mget</span></span></pre><pre
style=';;'><span
class=hljs-operator><span lang=EN-US style='font-family:Consolas;color:black;
'>      - indices:</span></span><span class=hljs-keyword><b><span
lang=EN-US style='font-family:Consolas;color:#AA0D91;'>data</span></b></span><span
class=hljs-operator><span lang=EN-US style='font-family:Consolas;color:black;
'>/</span></span><span class=hljs-keyword><b><span lang=EN-US
style='font-family:Consolas;color:#AA0D91;'>read</span></b></span><span
class=hljs-operator><span lang=EN-US style='font-family:Consolas;color:black;
'>/search</span></span></pre><pre style=';
;'><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'>      - indices:</span></span><span
class=hljs-keyword><b><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>data</span></b></span><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'>/</span></span><span
class=hljs-keyword><b><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>write</span></b></span><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'>/</span></span><span
class=hljs-keyword><b><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>delete</span></b></span></pre><pre style=';
;'><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'>      - indices:</span></span><span
class=hljs-keyword><b><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>data</span></b></span><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'>/</span></span><span
class=hljs-keyword><b><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>write</span></b></span><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'>/</span></span><span
class=hljs-keyword><b><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>index</span></b></span></pre><pre style=';
;'><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'>      - indices:</span></span><span
class=hljs-keyword><b><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>data</span></b></span><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'>/</span></span><span
class=hljs-keyword><b><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>write</span></b></span><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'>/</span></span><span
class=hljs-keyword><b><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>update</span></b></span></pre><pre style=';
;'><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'>      - indices:admin/</span></span><span
class=hljs-keyword><b><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>create</span></b></span></pre><pre style=';
;'><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'>&nbsp;</span></span></pre><pre
style=';;'><span
class=hljs-operator><span lang=EN-US style='font-family:Consolas;color:black;
'># The required permissions </span></span><span
class=hljs-keyword><b><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>for</span></b></span><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'> the kibana </span></span><span
class=hljs-number><span lang=EN-US style='font-family:Consolas;color:#1C00CF;
'>4</span></span><span class=hljs-operator><span lang=EN-US
style='font-family:Consolas;color:black;'> </span></span><span
class=hljs-keyword><b><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>server</span></b></span></pre><pre style=';
;'><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'>kibana4_server:</span></span></pre><pre
style=';;'><span
class=hljs-operator><span lang=EN-US style='font-family:Consolas;color:black;
'>  cluster:</span></span></pre><pre style=';
;'><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'>      - cluster:monitor/nodes/info</span></span></pre><pre
style=';;'><span
class=hljs-operator><span lang=EN-US style='font-family:Consolas;color:black;
'>      - cluster:monitor/health</span></span></pre><pre
style=';;'><span
class=hljs-operator><span lang=EN-US style='font-family:Consolas;color:black;
'>  indices:</span></span></pre><pre style=';
;'><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'>    </span></span><span
class=hljs-string><span lang=EN-US style='font-family:Consolas;color:#C41A16;
'>'.kibana'</span></span><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'>:</span></span></pre><pre
style=';;'><span
class=hljs-operator><span lang=EN-US style='font-family:Consolas;color:black;
'>      - indices:admin/</span></span><span class=hljs-keyword><b><span
lang=EN-US style='font-family:Consolas;color:#AA0D91;'>exists</span></b></span></pre><pre
style=';;'><span
class=hljs-operator><span lang=EN-US style='font-family:Consolas;color:black;
'>      - indices:admin/mapping/put</span></span></pre><pre
style=';;'><span
class=hljs-operator><span lang=EN-US style='font-family:Consolas;color:black;
'>      - indices:admin/mappings/</span></span><span
class=hljs-keyword><b><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>fields</span></b></span><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'>/</span></span><span
class=hljs-keyword><b><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>get</span></b></span></pre><pre style=';
;'><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'>      - indices:admin/refresh</span></span></pre><pre
style=';;'><span
class=hljs-operator><span lang=EN-US style='font-family:Consolas;color:black;
'>      - indices:admin/validate/</span></span><span
class=hljs-keyword><b><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>query</span></b></span></pre><pre style=';
;'><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'>      - indices:</span></span><span
class=hljs-keyword><b><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>data</span></b></span><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'>/</span></span><span
class=hljs-keyword><b><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>read</span></b></span><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'>/</span></span><span
class=hljs-keyword><b><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>get</span></b></span></pre><pre style=';
;'><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'>      - indices:</span></span><span
class=hljs-keyword><b><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>data</span></b></span><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'>/</span></span><span
class=hljs-keyword><b><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>read</span></b></span><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'>/mget</span></span></pre><pre
style=';;'><span
class=hljs-operator><span lang=EN-US style='font-family:Consolas;color:black;
'>      - indices:</span></span><span class=hljs-keyword><b><span
lang=EN-US style='font-family:Consolas;color:#AA0D91;'>data</span></b></span><span
class=hljs-operator><span lang=EN-US style='font-family:Consolas;color:black;
'>/</span></span><span class=hljs-keyword><b><span lang=EN-US
style='font-family:Consolas;color:#AA0D91;'>read</span></b></span><span
class=hljs-operator><span lang=EN-US style='font-family:Consolas;color:black;
'>/search</span></span></pre><pre style=';
;'><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'>      - indices:</span></span><span
class=hljs-keyword><b><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>data</span></b></span><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'>/</span></span><span
class=hljs-keyword><b><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>write</span></b></span><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'>/</span></span><span
class=hljs-keyword><b><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>delete</span></b></span></pre><pre style=';
;'><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'>      - indices:</span></span><span
class=hljs-keyword><b><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>data</span></b></span><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'>/</span></span><span
class=hljs-keyword><b><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>write</span></b></span><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'>/</span></span><span
class=hljs-keyword><b><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>index</span></b></span></pre><pre style=';
;'><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'>      - indices:</span></span><span
class=hljs-keyword><b><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>data</span></b></span><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'>/</span></span><span
class=hljs-keyword><b><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>write</span></b></span><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'>/</span></span><span
class=hljs-keyword><b><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>update</span></b></span></pre><pre style=';
;'><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'>&nbsp;</span></span></pre><pre
style=';;'><span
class=hljs-operator><span lang=EN-US style='font-family:Consolas;color:black;
'># The required role </span></span><span class=hljs-keyword><b><span
lang=EN-US style='font-family:Consolas;color:#AA0D91;'>for</span></b></span><span
class=hljs-operator><span lang=EN-US style='font-family:Consolas;color:black;
'> logstash users</span></span></pre><pre style='line-height:
16.8pt;;'><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'>logstash:</span></span></pre><pre
style=';;'><span
class=hljs-operator><span lang=EN-US style='font-family:Consolas;color:black;
'>  cluster: indices:admin/template/</span></span><span
class=hljs-keyword><b><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>get</span></b></span><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'>, indices:admin/template/put</span></span></pre><pre
style=';;'><span
class=hljs-operator><span lang=EN-US style='font-family:Consolas;color:black;
'>  indices:</span></span></pre><pre style=';
;'><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'>    </span></span><span
class=hljs-string><span lang=EN-US style='font-family:Consolas;color:#C41A16;
'>'logstash-*'</span></span><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'>: indices:</span></span><span
class=hljs-keyword><b><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>data</span></b></span><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'>/</span></span><span
class=hljs-keyword><b><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>write</span></b></span><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'>/bulk, indices:</span></span><span
class=hljs-keyword><b><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>data</span></b></span><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'>/</span></span><span
class=hljs-keyword><b><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>write</span></b></span><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'>/</span></span><span
class=hljs-keyword><b><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>delete</span></b></span><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'>, indices:</span></span><span
class=hljs-keyword><b><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>data</span></b></span><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'>/</span></span><span
class=hljs-keyword><b><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>write</span></b></span><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'>/</span></span><span
class=hljs-keyword><b><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>update</span></b></span><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'>, indices:</span></span><span
class=hljs-keyword><b><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>data</span></b></span><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'>/</span></span><span
class=hljs-keyword><b><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>read</span></b></span><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'>/search, indices:</span></span><span
class=hljs-keyword><b><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>data</span></b></span><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'>/</span></span><span
class=hljs-keyword><b><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>read</span></b></span><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'>/</span></span><span
class=hljs-keyword><b><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>scroll</span></b></span><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'>, create_index</span></span></pre><pre
style=';;'><span
class=hljs-operator><span lang=EN-US style='font-family:Consolas;color:black;
'>&nbsp;</span></span></pre><pre style=';
;'><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'># Marvel role, allowing </span></span><span
class=hljs-keyword><b><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>all</span></b></span><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'> operations</span></span></pre><pre
style=';;'><span
class=hljs-operator><span lang=EN-US style='font-family:Consolas;color:black;
'># </span></span><span class=hljs-keyword><b><span lang=EN-US
style='font-family:Consolas;color:#AA0D91;'>on</span></b></span><span
class=hljs-operator><span lang=EN-US style='font-family:Consolas;color:black;
'> the marvel indices</span></span></pre><pre style='line-height:
16.8pt;;'><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'>marvel_user:</span></span></pre><pre
style=';;'><span
class=hljs-operator><span lang=EN-US style='font-family:Consolas;color:black;
'>  cluster: cluster:monitor/nodes/info, cluster:admin/</span></span><span
class=hljs-keyword><b><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>plugin</span></b></span><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'>/license/</span></span><span
class=hljs-keyword><b><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>get</span></b></span></pre><pre style=';
;'><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'>  indices:</span></span></pre><pre
style=';;'><span
class=hljs-operator><span lang=EN-US style='font-family:Consolas;color:black;
'>    </span></span><span class=hljs-string><span lang=EN-US
style='font-family:Consolas;color:#C41A16;'>'.marvel-*'</span></span><span
class=hljs-operator><span lang=EN-US style='font-family:Consolas;color:black;
'>: </span></span><span class=hljs-keyword><b><span lang=EN-US
style='font-family:Consolas;color:#AA0D91;'>all</span></b></span></pre><pre
style=';;'><span
class=hljs-operator><span lang=EN-US style='font-family:Consolas;color:black;
'>&nbsp;</span></span></pre><pre style=';
;'><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'># Marvel Agent users</span></span></pre><pre
style=';;'><span
class=hljs-operator><span lang=EN-US style='font-family:Consolas;color:black;
'>marvel_agent:</span></span></pre><pre style='line-height:
16.8pt;;'><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'>  cluster: indices:admin/template/</span></span><span
class=hljs-keyword><b><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>get</span></b></span><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'>, indices:admin/template/put</span></span></pre><pre
style=';;'><span
class=hljs-operator><span lang=EN-US style='font-family:Consolas;color:black;
'>  indices:</span></span></pre><pre style=';
;'><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'>    </span></span><span
class=hljs-string><span lang=EN-US style='font-family:Consolas;color:#C41A16;
'>'.marvel-*'</span></span><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'>: indices:</span></span><span
class=hljs-keyword><b><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>data</span></b></span><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'>/</span></span><span
class=hljs-keyword><b><span lang=EN-US style='font-family:Consolas;color:#AA0D91;
'>write</span></b></span><span class=hljs-operator><span
lang=EN-US style='font-family:Consolas;color:black;'>/bulk, create_index</span></span></pre><pre
style=';;'><span
class=hljs-operator><span lang=EN-US style='font-family:Consolas;color:black;
'>&nbsp;</span></span></pre>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:6.75pt;margin-left:
0cm;;'><span style='font-size:10.5pt;
color:#333333'>通过配置文件可以看出，权限控制精确到具体的接口，读写，以及常见的组件权限</span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:6.75pt;margin-left:
0cm;;'><span lang=EN-US style='font-size:
10.5pt;font-family:"Helvetica","sans-serif";color:#333333'>&nbsp;</span></p>

<h3><a name="_Toc416884152"><span lang=EN-US>elastic</span></a><span
style='font-family:宋体'>的备份</span></h3>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:6.75pt;margin-left:
0cm;;'><span style='font-size:10.5pt;
color:#333333'>虽说</span><span lang=EN-US style='font-size:10.5pt;font-family:
"Helvetica","sans-serif";color:#333333'>elastic</span><span style='font-size:
10.5pt;color:#333333'>自身是分布式，可万一误操作，导致数据丢失就不是我们所能忍受的了。这里我们基于</span><span
lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif";
color:#333333'>elastic</span><span style='font-size:10.5pt;color:#333333'>的</span><span
lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif";
color:#333333'>repository</span><span style='font-size:10.5pt;color:#333333'>及</span><span
lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif";
color:#333333'>snapshot</span><span style='font-size:10.5pt;color:#333333'>特性，对</span><span
lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif";
color:#333333'>kibana</span><span style='font-size:10.5pt;color:#333333'>的配置做一次备份。</span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:6.75pt;margin-left:
0cm;;'><span style='font-size:10.5pt;
color:#333333'>下面直接上脚本：</span></p>

<pre style=';;'><span
class=hljs-shebang><span lang=EN-US style='font-family:Consolas;color:#1C00CF;
'>#!/bin/bash</span></span></pre><pre style=';
;'><span class=hljs-comment><span
lang=EN-US style='font-family:Consolas;color:#006A00;'># 2015-04-01</span></span></pre><pre
style=';;'><code><span
lang=EN-US style='font-family:Consolas;color:black;'>&nbsp;</span></code></pre><pre
style=';;'><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'>DATE=`date +%F`</span></span></pre><pre style=';
;'><span class=line><span lang=EN-US
style='font-family:Consolas;color:black;'>DEL_DATE=`date +%F </span></span><span
class=hljs-operator><span lang=EN-US style='font-family:Consolas;color:black;
'>-d</span></span><span class=line><span lang=EN-US
style='font-family:Consolas;color:black;'> </span></span><span
class=hljs-string><span lang=EN-US style='font-family:Consolas;color:#C41A16;
'>&quot;-3 days&quot;</span></span><span class=line><span
lang=EN-US style='font-family:Consolas;color:black;'>`</span></span></pre><pre
style=';;'><span
class=hljs-builtin><b><span lang=EN-US style='font-family:Consolas;color:#5C2699;
'>echo</span></b></span><span class=line><span lang=EN-US
style='font-family:Consolas;color:black;'> </span></span><span
class=hljs-variable><b><span lang=EN-US style='font-family:Consolas;color:#3F6E74;
'>$DATE</span></b></span></pre><pre style=';
;'><code><span lang=EN-US style='font-family:
Consolas;color:black;'>&nbsp;</span></code></pre><pre
style=';;'><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>##create repository</span></span></pre><pre style='line-height:
16.8pt;;'><span class=hljs-comment><span
lang=EN-US style='font-family:Consolas;color:#006A00;'>#curl -XPUT 'http://localhost:9200/_snapshot/kibana' -d '{</span></span></pre><pre
style=';;'><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>#    &quot;type&quot;: &quot;fs&quot;,</span></span></pre><pre
style=';;'><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>#    &quot;settings&quot;: {</span></span></pre><pre
style=';;'><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>#        &quot;location&quot;: &quot;/home/bot/kibana_backup&quot;,</span></span></pre><pre
style=';;'><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>#        &quot;compress&quot;: true</span></span></pre><pre
style=';;'><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>#    }</span></span></pre><pre style=';
;'><span class=hljs-comment><span
lang=EN-US style='font-family:Consolas;color:#006A00;'>#}'</span></span></pre><pre
style=';;'><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>#</span></span></pre><pre style=';
;'><code><span lang=EN-US style='font-family:
Consolas;color:black;'>&nbsp;</span></code></pre><pre
style=';;'><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>##</span></span><span class=hljs-comment><span
style='color:#006A00;'>查看</span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>repo</span></span></pre><pre style=';
;'><span class=hljs-comment><span
lang=EN-US style='font-family:Consolas;color:#006A00;'>#curl -XGET 'http://localhost:9200/_snapshot/kibana?pretty'</span></span></pre><pre
style=';;'><code><span
lang=EN-US style='font-family:Consolas;color:black;'>&nbsp;</span></code></pre><pre
style=';;'><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>##create snapshot</span></span></pre><pre style='line-height:
16.8pt;;'><code><span lang=EN-US
style='font-family:Consolas;color:black;'>&nbsp;</span></code></pre><pre
style=';;'><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'>curl -XPUT </span></span><span class=hljs-string><span lang=EN-US
style='font-family:Consolas;color:#C41A16;'>&quot;localhost:9200/_snapshot/kibana/kibana_repo_</span></span><span
class=hljs-variable><b><span lang=EN-US style='font-family:Consolas;color:#3F6E74;
'>${DATE}</span></b></span><span class=hljs-string><span
lang=EN-US style='font-family:Consolas;color:#C41A16;'>&quot;</span></span><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'> </span></span><span class=hljs-operator><span lang=EN-US
style='font-family:Consolas;color:black;'>-d</span></span><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'> </span></span><span class=hljs-string><span lang=EN-US
style='font-family:Consolas;color:#C41A16;'>'{</span></span></pre><pre
style=';;'><span
class=hljs-string><span lang=EN-US style='font-family:Consolas;color:#C41A16;
'>    &quot;indices&quot;: &quot;.kibana&quot;,</span></span></pre><pre
style=';;'><span
class=hljs-string><span lang=EN-US style='font-family:Consolas;color:#C41A16;
'>    &quot;ignore_unavailable&quot;: &quot;true&quot;,</span></span></pre><pre
style=';;'><span
class=hljs-string><span lang=EN-US style='font-family:Consolas;color:#C41A16;
'>    &quot;include_global_state&quot;: false</span></span></pre><pre
style=';;'><span
class=hljs-string><span lang=EN-US style='font-family:Consolas;color:#C41A16;
'>}'</span></span></pre><pre style=';
;'><code><span lang=EN-US style='font-family:
Consolas;color:black;'>&nbsp;</span></code></pre><pre
style=';;'><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>##</span></span><span class=hljs-comment><span
style='color:#006A00;'>只保存最近</span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>3</span></span><span class=hljs-comment><span
style='color:#006A00;'>天</span></span></pre><pre
style=';;'><span
class=line><span lang=EN-US style='font-family:Consolas;color:black;'> curl -XDELETE </span></span><span class=hljs-string><span lang=EN-US
style='font-family:Consolas;color:#C41A16;'>&quot;localhost:9200/_snapshot/kibana/kibana_repo_</span></span><span
class=hljs-variable><b><span lang=EN-US style='font-family:Consolas;color:#3F6E74;
'>${DEL_DATE}</span></b></span><span class=hljs-string><span
lang=EN-US style='font-family:Consolas;color:#C41A16;'>&quot;</span></span></pre><pre
style=';;'><code><span
lang=EN-US style='font-family:Consolas;color:black;'>&nbsp;</span></code></pre><pre
style=';;'><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>##</span></span><span class=hljs-comment><span
style='color:#006A00;'>恢复</span></span></pre><pre
style=';;'><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>#</span></span></pre><pre style=';
;'><span class=hljs-comment><span
lang=EN-US style='font-family:Consolas;color:#006A00;'>##</span></span><span
class=hljs-comment><span style='color:#006A00;'>恢复之前需要将</span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>index</span></span><span class=hljs-comment><span
style='color:#006A00;'>关闭</span></span></pre><pre
style=';;'><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>#curl -XPOST 'localhost:9200/.kibana/_close'</span></span></pre><pre
style=';;'><code><span
lang=EN-US style='font-family:Consolas;color:black;'>&nbsp;</span></code></pre><pre
style=';;'><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>#curl -XPOST &quot;localhost:9200/_snapshot/kibana/kibana_repo_${DATE}/_restore&quot;</span></span></pre><pre
style=';;'><code><span
lang=EN-US style='font-family:Consolas;color:black;'>&nbsp;</span></code></pre><pre
style=';;'><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>##</span></span><span class=hljs-comment><span
style='color:#006A00;'>恢复之后将</span></span><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>index</span></span><span class=hljs-comment><span
style='color:#006A00;'>打开</span></span></pre><pre
style=';;'><span
class=hljs-comment><span lang=EN-US style='font-family:Consolas;color:#006A00;
'>#curl -XPOST 'localhost:9200/.kibana/_open'</span></span></pre><pre
style=';;'><code><span
lang=EN-US style='font-family:Consolas;color:black;'>&nbsp;</span></code></pre><pre
style=';;'><code><span
lang=EN-US style='font-family:Consolas;color:black;'>&nbsp;</span></code></pre>

<h2><a name="_Toc416884153"><span lang=EN-US>Kafka</span></a><span
style='font-family:黑体'>子系统简介</span></h2>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:6.75pt;margin-left:
0cm;'><span lang=EN-US style='font-size:10.5pt;font-family:
"Helvetica","sans-serif";color:#333333'>Kibana </span><span style='font-size:
10.5pt;color:#333333'>是为</span><span lang=EN-US style='font-size:10.5pt;
font-family:"Helvetica","sans-serif";color:#333333'> Elasticsearch </span><span
style='font-size:10.5pt;color:#333333'>设计的开源分析和可视化平台。你可以使用</span><span
lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif";
color:#333333'> Kibana </span><span style='font-size:10.5pt;color:#333333'>来搜索，查看存储在</span><span
lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif";
color:#333333'> Elasticsearch </span><span style='font-size:10.5pt;color:#333333'>索引中的数据并与之交互。你可以很容易实现高级的数据分析和可视化，以图标的形式展现出来。</span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:6.75pt;margin-left:
0cm;'><span lang=EN-US style='font-size:10.5pt;font-family:
"Helvetica","sans-serif";color:#333333'>Kibana </span><span style='font-size:
10.5pt;color:#333333'>让海量数据变得更容易理解。简单的基于浏览器的界面让你可以快速创建并分享动态的仪表板，用以实时修改</span><span
lang=EN-US style='font-size:10.5pt;font-family:"Helvetica","sans-serif";
color:#333333'> Elasticsearch </span><span style='font-size:10.5pt;color:#333333'>请求。</span></p>

<p style='margin-top:0cm;margin-right:0cm;margin-bottom:6.75pt;margin-left:
0cm;'><span style='font-size:10.5pt;color:#333333'>具体的配置详见：</span><span
lang=EN-US><a href="http://kibana.logstash.es/content/v4/README.html"><span
style='font-size:10.5pt;font-family:"Helvetica","sans-serif";color:#446E9B'>http://kibana.logstash.es/content/v4/README.html</span></a></span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

</div>

</body>
