---
layout: default
---

<head>
<meta http-equiv=Content-Type content="text/html; charset=utf-8">
<meta name=Generator content="Microsoft Word 12 (filtered)">
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:宋体;
	panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Tahoma;
	panose-1:2 11 6 4 3 5 4 4 2 4;}
@font-face
	{font-family:微软雅黑;
	panose-1:2 11 5 3 2 2 4 2 2 4;}
@font-face
	{font-family:"\@宋体";
	panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
	{font-family:"\@微软雅黑";
	panose-1:2 11 5 3 2 2 4 2 2 4;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:10.0pt;
	margin-left:0cm;
	layout-grid-mode:char;
	font-size:11.0pt;
	font-family:"Tahoma","sans-serif";}
h1
	{mso-style-link:"标题 1 Char";
	margin-top:17.0pt;
	margin-right:0cm;
	margin-bottom:16.5pt;
	margin-left:0cm;
	line-height:240%;
	page-break-after:avoid;
	layout-grid-mode:char;
	font-size:22.0pt;
	font-family:"Tahoma","sans-serif";}
pre
	{mso-style-link:"HTML 预设格式 Char";
	margin:0cm;
	margin-bottom:.0001pt;
	font-size:12.0pt;
	font-family:宋体;}
span.HTMLChar
	{mso-style-name:"HTML 预设格式 Char";
	mso-style-link:"HTML 预设格式";
	font-family:宋体;}
span.1Char
	{mso-style-name:"标题 1 Char";
	mso-style-link:"标题 1";
	font-family:"Tahoma","sans-serif";
	font-weight:bold;}
.MsoChpDefault
	{font-size:11.0pt;}
.MsoPapDefault
	{margin-bottom:10.0pt;
	line-height:11.0pt;}
 /* Page Definitions */
 @page WordSection1
	{size:595.3pt 841.9pt;
	margin:72.0pt 90.0pt 72.0pt 90.0pt;}
div.WordSection1
	{page:WordSection1;}
-->
</style>

</head>

<body lang=ZH-CN>

<div class=WordSection1>

<h1 align=center style='text-align:center'><span style='font-family:"微软雅黑","sans-serif"'>常见字符串哈希算法</span></h1>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
13.5pt;layout-grid-mode:both'><span lang=EN-US style='font-size:9.0pt;
font-family:宋体;color:green'>// SDBM Hash Function</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
13.5pt;layout-grid-mode:both'><span lang=EN-US style='font-size:9.0pt;
font-family:宋体;color:black'>unsigned </span><span lang=EN-US style='font-size:
9.0pt;font-family:宋体;color:blue'>int</span><span lang=EN-US style='font-size:
9.0pt;font-family:宋体;color:black'> SDBMHash(</span><span lang=EN-US
style='font-size:9.0pt;font-family:宋体;color:blue'>char</span><span lang=EN-US
style='font-size:9.0pt;font-family:宋体;color:black'> *str)<br>
{<br>
    unsigned </span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;
color:blue'>int</span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;
color:black'> hash = </span><span lang=EN-US style='font-size:9.0pt;font-family:
宋体;color:purple'>0</span><span lang=EN-US style='font-size:9.0pt;font-family:
宋体;color:black'>;<br>
 <br>
    </span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;color:blue'>while</span><span
lang=EN-US style='font-size:9.0pt;font-family:宋体;color:black'> (*str)<br>
    {<br>
        </span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;
color:green'>// equivalent to: hash = 65599*hash + (*str++);<br>
</span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;color:black'>       
hash = (*str++) + (hash &lt;&lt; </span><span lang=EN-US style='font-size:9.0pt;
font-family:宋体;color:purple'>6</span><span lang=EN-US style='font-size:9.0pt;
font-family:宋体;color:black'>) + (hash &lt;&lt; </span><span lang=EN-US
style='font-size:9.0pt;font-family:宋体;color:purple'>16</span><span lang=EN-US
style='font-size:9.0pt;font-family:宋体;color:black'>) - hash;<br>
    }<br>
 <br>
    </span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;color:blue'>return</span><span
lang=EN-US style='font-size:9.0pt;font-family:宋体;color:black'> (hash &amp; </span><span
lang=EN-US style='font-size:9.0pt;font-family:宋体;color:purple'>0x7FFFFFFF</span><span
lang=EN-US style='font-size:9.0pt;font-family:宋体;color:black'>);<br>
}<br>
 <br>
</span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;color:green'>// RS
Hash Function<br>
</span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;color:black'>unsigned
</span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;color:blue'>int</span><span
lang=EN-US style='font-size:9.0pt;font-family:宋体;color:black'> RSHash(</span><span
lang=EN-US style='font-size:9.0pt;font-family:宋体;color:blue'>char</span><span
lang=EN-US style='font-size:9.0pt;font-family:宋体;color:black'> *str)<br>
{<br>
    unsigned </span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;
color:blue'>int</span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;
color:black'> b = </span><span lang=EN-US style='font-size:9.0pt;font-family:
宋体;color:purple'>378551</span><span lang=EN-US style='font-size:9.0pt;
font-family:宋体;color:black'>;<br>
    unsigned </span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;
color:blue'>int</span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;
color:black'> a = </span><span lang=EN-US style='font-size:9.0pt;font-family:
宋体;color:purple'>63689</span><span lang=EN-US style='font-size:9.0pt;
font-family:宋体;color:black'>;<br>
    unsigned </span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;
color:blue'>int</span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;
color:black'> hash = </span><span lang=EN-US style='font-size:9.0pt;font-family:
宋体;color:purple'>0</span><span lang=EN-US style='font-size:9.0pt;font-family:
宋体;color:black'>;<br>
 <br>
    </span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;color:blue'>while</span><span
lang=EN-US style='font-size:9.0pt;font-family:宋体;color:black'> (*str)<br>
    {<br>
        hash = hash * a + (*str++);<br>
        a *= b;<br>
    }<br>
 <br>
    </span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;color:blue'>return</span><span
lang=EN-US style='font-size:9.0pt;font-family:宋体;color:black'> (hash &amp; </span><span
lang=EN-US style='font-size:9.0pt;font-family:宋体;color:purple'>0x7FFFFFFF</span><span
lang=EN-US style='font-size:9.0pt;font-family:宋体;color:black'>);<br>
}<br>
 <br>
</span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;color:green'>//
JS Hash Function<br>
</span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;color:black'>unsigned
</span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;color:blue'>int</span><span
lang=EN-US style='font-size:9.0pt;font-family:宋体;color:black'> JSHash(</span><span
lang=EN-US style='font-size:9.0pt;font-family:宋体;color:blue'>char</span><span
lang=EN-US style='font-size:9.0pt;font-family:宋体;color:black'> *str)<br>
{<br>
    unsigned </span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;
color:blue'>int</span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;
color:black'> hash = </span><span lang=EN-US style='font-size:9.0pt;font-family:
宋体;color:purple'>1315423911</span><span lang=EN-US style='font-size:9.0pt;
font-family:宋体;color:black'>;<br>
 <br>
    </span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;color:blue'>while</span><span
lang=EN-US style='font-size:9.0pt;font-family:宋体;color:black'> (*str)<br>
    {<br>
        hash ^= ((hash &lt;&lt; </span><span lang=EN-US style='font-size:9.0pt;
font-family:宋体;color:purple'>5</span><span lang=EN-US style='font-size:9.0pt;
font-family:宋体;color:black'>) + (*str++) + (hash &gt;&gt; </span><span
lang=EN-US style='font-size:9.0pt;font-family:宋体;color:purple'>2</span><span
lang=EN-US style='font-size:9.0pt;font-family:宋体;color:black'>));<br>
    }<br>
 <br>
    </span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;color:blue'>return</span><span
lang=EN-US style='font-size:9.0pt;font-family:宋体;color:black'> (hash &amp; </span><span
lang=EN-US style='font-size:9.0pt;font-family:宋体;color:purple'>0x7FFFFFFF</span><span
lang=EN-US style='font-size:9.0pt;font-family:宋体;color:black'>);<br>
}<br>
 <br>
</span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;color:green'>//
P. J. Weinberger Hash Function<br>
</span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;color:black'>unsigned
</span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;color:blue'>int</span><span
lang=EN-US style='font-size:9.0pt;font-family:宋体;color:black'> PJWHash(</span><span
lang=EN-US style='font-size:9.0pt;font-family:宋体;color:blue'>char</span><span
lang=EN-US style='font-size:9.0pt;font-family:宋体;color:black'> *str)<br>
{<br>
    unsigned </span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;
color:blue'>int</span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;
color:black'> BitsInUnignedInt = (unsigned </span><span lang=EN-US
style='font-size:9.0pt;font-family:宋体;color:blue'>int</span><span lang=EN-US
style='font-size:9.0pt;font-family:宋体;color:black'>)(</span><span lang=EN-US
style='font-size:9.0pt;font-family:宋体;color:blue'>sizeof</span><span
lang=EN-US style='font-size:9.0pt;font-family:宋体;color:black'>(unsigned </span><span
lang=EN-US style='font-size:9.0pt;font-family:宋体;color:blue'>int</span><span
lang=EN-US style='font-size:9.0pt;font-family:宋体;color:black'>) * </span><span
lang=EN-US style='font-size:9.0pt;font-family:宋体;color:purple'>8</span><span
lang=EN-US style='font-size:9.0pt;font-family:宋体;color:black'>);<br>
    unsigned </span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;
color:blue'>int</span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;
color:black'> ThreeQuarters    = (unsigned </span><span lang=EN-US
style='font-size:9.0pt;font-family:宋体;color:blue'>int</span><span lang=EN-US
style='font-size:9.0pt;font-family:宋体;color:black'>)((BitsInUnignedInt  * </span><span
lang=EN-US style='font-size:9.0pt;font-family:宋体;color:purple'>3</span><span
lang=EN-US style='font-size:9.0pt;font-family:宋体;color:black'>) / </span><span
lang=EN-US style='font-size:9.0pt;font-family:宋体;color:purple'>4</span><span
lang=EN-US style='font-size:9.0pt;font-family:宋体;color:black'>);<br>
    unsigned </span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;
color:blue'>int</span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;
color:black'> OneEighth        = (unsigned </span><span lang=EN-US
style='font-size:9.0pt;font-family:宋体;color:blue'>int</span><span lang=EN-US
style='font-size:9.0pt;font-family:宋体;color:black'>)(BitsInUnignedInt / </span><span
lang=EN-US style='font-size:9.0pt;font-family:宋体;color:purple'>8</span><span
lang=EN-US style='font-size:9.0pt;font-family:宋体;color:black'>);<br>
    unsigned </span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;
color:blue'>int</span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;
color:black'> HighBits         = (unsigned </span><span lang=EN-US
style='font-size:9.0pt;font-family:宋体;color:blue'>int</span><span lang=EN-US
style='font-size:9.0pt;font-family:宋体;color:black'>)(</span><span lang=EN-US
style='font-size:9.0pt;font-family:宋体;color:purple'>0xFFFFFFFF</span><span
lang=EN-US style='font-size:9.0pt;font-family:宋体;color:black'>) &lt;&lt;
(BitsInUnignedInt - OneEighth);<br>
    unsigned </span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;
color:blue'>int</span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;
color:black'> hash             = </span><span lang=EN-US style='font-size:9.0pt;
font-family:宋体;color:purple'>0</span><span lang=EN-US style='font-size:9.0pt;
font-family:宋体;color:black'>;<br>
    unsigned </span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;
color:blue'>int</span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;
color:black'> test             = </span><span lang=EN-US style='font-size:9.0pt;
font-family:宋体;color:purple'>0</span><span lang=EN-US style='font-size:9.0pt;
font-family:宋体;color:black'>;<br>
 <br>
    </span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;color:blue'>while</span><span
lang=EN-US style='font-size:9.0pt;font-family:宋体;color:black'> (*str)<br>
    {<br>
        hash = (hash &lt;&lt; OneEighth) + (*str++);<br>
        </span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;
color:blue'>if</span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;
color:black'> ((test = hash &amp; HighBits) != </span><span lang=EN-US
style='font-size:9.0pt;font-family:宋体;color:purple'>0</span><span lang=EN-US
style='font-size:9.0pt;font-family:宋体;color:black'>)<br>
        {<br>
            hash = ((hash ^ (test &gt;&gt; ThreeQuarters)) &amp; (~HighBits));<br>
        }<br>
    }<br>
 <br>
    </span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;color:blue'>return</span><span
lang=EN-US style='font-size:9.0pt;font-family:宋体;color:black'> (hash &amp; </span><span
lang=EN-US style='font-size:9.0pt;font-family:宋体;color:purple'>0x7FFFFFFF</span><span
lang=EN-US style='font-size:9.0pt;font-family:宋体;color:black'>);<br>
}<br>
 <br>
</span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;color:green'>//
ELF Hash Function<br>
</span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;color:black'>unsigned
</span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;color:blue'>int</span><span
lang=EN-US style='font-size:9.0pt;font-family:宋体;color:black'> ELFHash(</span><span
lang=EN-US style='font-size:9.0pt;font-family:宋体;color:blue'>char</span><span
lang=EN-US style='font-size:9.0pt;font-family:宋体;color:black'> *str)<br>
{<br>
    unsigned </span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;
color:blue'>int</span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;
color:black'> hash = </span><span lang=EN-US style='font-size:9.0pt;font-family:
宋体;color:purple'>0</span><span lang=EN-US style='font-size:9.0pt;font-family:
宋体;color:black'>;<br>
    unsigned </span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;
color:blue'>int</span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;
color:black'> x    = </span><span lang=EN-US style='font-size:9.0pt;font-family:
宋体;color:purple'>0</span><span lang=EN-US style='font-size:9.0pt;font-family:
宋体;color:black'>;<br>
 <br>
    </span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;color:blue'>while</span><span
lang=EN-US style='font-size:9.0pt;font-family:宋体;color:black'> (*str)<br>
    {<br>
        hash = (hash &lt;&lt; </span><span lang=EN-US style='font-size:9.0pt;
font-family:宋体;color:purple'>4</span><span lang=EN-US style='font-size:9.0pt;
font-family:宋体;color:black'>) + (*str++);<br>
        </span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;
color:blue'>if</span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;
color:black'> ((x = hash &amp; </span><span lang=EN-US style='font-size:9.0pt;
font-family:宋体;color:purple'>0xF0000000L</span><span lang=EN-US
style='font-size:9.0pt;font-family:宋体;color:black'>) != </span><span
lang=EN-US style='font-size:9.0pt;font-family:宋体;color:purple'>0</span><span
lang=EN-US style='font-size:9.0pt;font-family:宋体;color:black'>)<br>
        {<br>
            hash ^= (x &gt;&gt; </span><span lang=EN-US style='font-size:9.0pt;
font-family:宋体;color:purple'>24</span><span lang=EN-US style='font-size:9.0pt;
font-family:宋体;color:black'>);<br>
            hash &amp;= ~x;<br>
        }<br>
    }<br>
 <br>
    </span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;color:blue'>return</span><span
lang=EN-US style='font-size:9.0pt;font-family:宋体;color:black'> (hash &amp; </span><span
lang=EN-US style='font-size:9.0pt;font-family:宋体;color:purple'>0x7FFFFFFF</span><span
lang=EN-US style='font-size:9.0pt;font-family:宋体;color:black'>);<br>
}<br>
 <br>
</span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;color:green'>//
BKDR Hash Function<br>
</span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;color:black'>unsigned
</span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;color:blue'>int</span><span
lang=EN-US style='font-size:9.0pt;font-family:宋体;color:black'> BKDRHash(</span><span
lang=EN-US style='font-size:9.0pt;font-family:宋体;color:blue'>char</span><span
lang=EN-US style='font-size:9.0pt;font-family:宋体;color:black'> *str)<br>
{<br>
    unsigned </span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;
color:blue'>int</span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;
color:black'> seed = </span><span lang=EN-US style='font-size:9.0pt;font-family:
宋体;color:purple'>131</span><span lang=EN-US style='font-size:9.0pt;font-family:
宋体;color:black'>; </span><span lang=EN-US style='font-size:9.0pt;font-family:
宋体;color:green'>// 31 131 1313 13131 131313 etc..<br>
</span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;color:black'>   
unsigned </span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;
color:blue'>int</span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;
color:black'> hash = </span><span lang=EN-US style='font-size:9.0pt;font-family:
宋体;color:purple'>0</span><span lang=EN-US style='font-size:9.0pt;font-family:
宋体;color:black'>;<br>
 <br>
    </span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;color:blue'>while</span><span
lang=EN-US style='font-size:9.0pt;font-family:宋体;color:black'> (*str)<br>
    {<br>
        hash = hash * seed + (*str++);<br>
    }<br>
 <br>
    </span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;color:blue'>return</span><span
lang=EN-US style='font-size:9.0pt;font-family:宋体;color:black'> (hash &amp; </span><span
lang=EN-US style='font-size:9.0pt;font-family:宋体;color:purple'>0x7FFFFFFF</span><span
lang=EN-US style='font-size:9.0pt;font-family:宋体;color:black'>);<br>
}<br>
 <br>
</span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;color:green'>//
DJB Hash Function<br>
</span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;color:black'>unsigned
</span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;color:blue'>int</span><span
lang=EN-US style='font-size:9.0pt;font-family:宋体;color:black'> DJBHash(</span><span
lang=EN-US style='font-size:9.0pt;font-family:宋体;color:blue'>char</span><span
lang=EN-US style='font-size:9.0pt;font-family:宋体;color:black'> *str)<br>
{<br>
    unsigned </span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;
color:blue'>int</span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;
color:black'> hash = </span><span lang=EN-US style='font-size:9.0pt;font-family:
宋体;color:purple'>5381</span><span lang=EN-US style='font-size:9.0pt;font-family:
宋体;color:black'>;<br>
 <br>
    </span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;color:blue'>while</span><span
lang=EN-US style='font-size:9.0pt;font-family:宋体;color:black'> (*str)<br>
    {<br>
        hash += (hash &lt;&lt; </span><span lang=EN-US style='font-size:9.0pt;
font-family:宋体;color:purple'>5</span><span lang=EN-US style='font-size:9.0pt;
font-family:宋体;color:black'>) + (*str++);<br>
    }<br>
 <br>
    </span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;color:blue'>return</span><span
lang=EN-US style='font-size:9.0pt;font-family:宋体;color:black'> (hash &amp; </span><span
lang=EN-US style='font-size:9.0pt;font-family:宋体;color:purple'>0x7FFFFFFF</span><span
lang=EN-US style='font-size:9.0pt;font-family:宋体;color:black'>);<br>
}<br>
 <br>
</span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;color:green'>//
AP Hash Function<br>
</span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;color:black'>unsigned
</span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;color:blue'>int</span><span
lang=EN-US style='font-size:9.0pt;font-family:宋体;color:black'> APHash(</span><span
lang=EN-US style='font-size:9.0pt;font-family:宋体;color:blue'>char</span><span
lang=EN-US style='font-size:9.0pt;font-family:宋体;color:black'> *str)<br>
{<br>
    unsigned </span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;
color:blue'>int</span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;
color:black'> hash = </span><span lang=EN-US style='font-size:9.0pt;font-family:
宋体;color:purple'>0</span><span lang=EN-US style='font-size:9.0pt;font-family:
宋体;color:black'>;<br>
    </span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;color:blue'>int</span><span
lang=EN-US style='font-size:9.0pt;font-family:宋体;color:black'> i;<br>
 <br>
    </span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;color:blue'>for</span><span
lang=EN-US style='font-size:9.0pt;font-family:宋体;color:black'> (i=</span><span
lang=EN-US style='font-size:9.0pt;font-family:宋体;color:purple'>0</span><span
lang=EN-US style='font-size:9.0pt;font-family:宋体;color:black'>; *str; i++)<br>
    {<br>
        </span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;
color:blue'>if</span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;
color:black'> ((i &amp; </span><span lang=EN-US style='font-size:9.0pt;
font-family:宋体;color:purple'>1</span><span lang=EN-US style='font-size:9.0pt;
font-family:宋体;color:black'>) == </span><span lang=EN-US style='font-size:9.0pt;
font-family:宋体;color:purple'>0</span><span lang=EN-US style='font-size:9.0pt;
font-family:宋体;color:black'>)<br>
        {<br>
            hash ^= ((hash &lt;&lt; </span><span lang=EN-US style='font-size:
9.0pt;font-family:宋体;color:purple'>7</span><span lang=EN-US style='font-size:
9.0pt;font-family:宋体;color:black'>) ^ (*str++) ^ (hash &gt;&gt; </span><span
lang=EN-US style='font-size:9.0pt;font-family:宋体;color:purple'>3</span><span
lang=EN-US style='font-size:9.0pt;font-family:宋体;color:black'>));<br>
        }<br>
        </span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;
color:blue'>else</span><span lang=EN-US style='font-size:9.0pt;font-family:
宋体;color:black'><br>
        {<br>
            hash ^= (~((hash &lt;&lt; </span><span lang=EN-US style='font-size:
9.0pt;font-family:宋体;color:purple'>11</span><span lang=EN-US style='font-size:
9.0pt;font-family:宋体;color:black'>) ^ (*str++) ^ (hash &gt;&gt; </span><span
lang=EN-US style='font-size:9.0pt;font-family:宋体;color:purple'>5</span><span
lang=EN-US style='font-size:9.0pt;font-family:宋体;color:black'>)));<br>
        }<br>
    }<br>
 <br>
    </span><span lang=EN-US style='font-size:9.0pt;font-family:宋体;color:blue'>return</span><span
lang=EN-US style='font-size:9.0pt;font-family:宋体;color:black'> (hash &amp; </span><span
lang=EN-US style='font-size:9.0pt;font-family:宋体;color:purple'>0x7FFFFFFF</span><span
lang=EN-US style='font-size:9.0pt;font-family:宋体;color:black'>);<br>
}</span></p>

<p class=MsoNormal style='line-height:11.0pt'><span lang=EN-US>&nbsp;</span></p>

<pre style='line-height:13.5pt'><span lang=EN-US style='font-size:9.0pt;
color:green'>//</span><span style='font-size:9.0pt;color:green'>用跟元素个数最接近的质数作为散列表的大小</span></pre><pre
style='line-height:13.5pt'><span lang=EN-US style='font-size:9.0pt;color:blue'>#define</span><span
lang=EN-US style='font-size:9.0pt;color:black'> NHASH 29989</span></pre><pre
style='line-height:13.5pt'><span lang=EN-US style='font-size:9.0pt;color:blue'>#define</span><span
lang=EN-US style='font-size:9.0pt;color:black'> MULT 31</span></pre><pre
style='line-height:13.5pt'><span lang=EN-US style='font-size:9.0pt;color:black'>&nbsp;</span></pre><pre
style='line-height:13.5pt'><span lang=EN-US style='font-size:9.0pt;color:black'>unsigned </span><span
lang=EN-US style='font-size:9.0pt;color:blue'>in</span><span lang=EN-US
style='font-size:9.0pt;color:black'> hash(</span><span lang=EN-US
style='font-size:9.0pt;color:blue'>char</span><span lang=EN-US
style='font-size:9.0pt;color:black'> *p)</span></pre><pre style='line-height:
13.5pt'><span lang=EN-US style='font-size:9.0pt;color:black'>{</span></pre><pre
style='line-height:13.5pt'><span lang=EN-US style='font-size:9.0pt;color:black'>    unsigned </span><span
lang=EN-US style='font-size:9.0pt;color:blue'>int</span><span lang=EN-US
style='font-size:9.0pt;color:black'> h = </span><span lang=EN-US
style='font-size:9.0pt;color:purple'>0</span><span lang=EN-US style='font-size:
9.0pt;color:black'>;</span></pre><pre style='line-height:13.5pt'><span
lang=EN-US style='font-size:9.0pt;color:black'>    </span><span lang=EN-US
style='font-size:9.0pt;color:blue'>for</span><span lang=EN-US style='font-size:
9.0pt;color:black'> (; *p; p++)</span></pre><pre style='line-height:13.5pt'><span
lang=EN-US style='font-size:9.0pt;color:black'>        h = MULT *h + *p;</span></pre><pre
style='line-height:13.5pt'><span lang=EN-US style='font-size:9.0pt;color:black'>    </span><span
lang=EN-US style='font-size:9.0pt;color:blue'>return</span><span lang=EN-US
style='font-size:9.0pt;color:black'> h % NHASH;</span></pre><pre
style='line-height:13.5pt'><span lang=EN-US style='font-size:9.0pt;color:black'>}</span></pre>

<p class=MsoNormal style='line-height:11.0pt'><span lang=EN-US>&nbsp;</span></p>

</div>

</body>
